<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Interrupt Descriptor Table - OSDev Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"3314730f38f70aee17fb2eae","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Interrupt_Descriptor_Table","wgTitle":"Interrupt Descriptor Table","wgCurRevisionId":29121,"wgRevisionId":29121,"wgArticleId":1545,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages using deprecated source tags","X86 CPU","Interrupts"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Interrupt_Descriptor_Table","wgRelevantArticleId":1545,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],
"wgRestrictionMove":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"nearby":false,"watchlist":false,"tagline":false},"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgVector2022PreviewPages":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgEditSubmitButtonLabelPublish":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.DarkMode.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.DarkMode","ext.moderation.notify","ext.moderation.ve","ext.moderation.ajaxhook","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=ext.DarkMode.styles%7Cext.pygments%7Cext.visualEditor.desktopArticleTarget.noscript%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://wiki.osdev.org/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.39.7"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="OSDev Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="OSDev Wiki Atom feed" href="https://wiki.osdev.org/index.php?title=Special:RecentChanges&amp;feed=atom"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Interrupt_Descriptor_Table rootpage-Interrupt_Descriptor_Table skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Interrupt Descriptor Table</span></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From OSDev Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="Interrupt_Descriptor_Table#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="Interrupt_Descriptor_Table#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><p>The <b>Interrupt Descriptor Table</b> (<b>IDT</b>) is a binary data structure specific to the <a href="IA32_Architecture_Family" title="IA32 Architecture Family">IA-32</a> and <a href="X86-64" title="X86-64">x86-64</a> architectures. It is the <a href="Protected_Mode" title="Protected Mode">Protected Mode</a> and Long Mode counterpart to the <a href="Real_Mode" title="Real Mode">Real Mode</a> Interrupt Vector Table (<a href="IVT" class="mw-redirect" title="IVT">IVT</a>) telling the CPU where the <a href="Interrupt_Service_Routines" title="Interrupt Service Routines">Interrupt Service Routines</a> (ISR) are located (one per interrupt vector). It is similar to the <a href="Global_Descriptor_Table" title="Global Descriptor Table">Global Descriptor Table</a> in structure.
</p><p>The IDT entries are called gates. It can contain Interrupt Gates, Task Gates and Trap Gates.
</p><p>Before you implement the IDT, make sure you have a working GDT.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Interrupt_Descriptor_Table#IDTR"><span class="tocnumber">1</span> <span class="toctext">IDTR</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Interrupt_Descriptor_Table#Structure_on_IA-32"><span class="tocnumber">2</span> <span class="toctext">Structure on IA-32</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="Interrupt_Descriptor_Table#Table"><span class="tocnumber">2.1</span> <span class="toctext">Table</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="Interrupt_Descriptor_Table#Gate_Descriptor"><span class="tocnumber">2.2</span> <span class="toctext">Gate Descriptor</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="Interrupt_Descriptor_Table#Example_Code"><span class="tocnumber">2.3</span> <span class="toctext">Example Code</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="Interrupt_Descriptor_Table#Structure_on_x86-64"><span class="tocnumber">3</span> <span class="toctext">Structure on x86-64</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="Interrupt_Descriptor_Table#Table_2"><span class="tocnumber">3.1</span> <span class="toctext">Table</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Interrupt_Descriptor_Table#Gate_Descriptor_2"><span class="tocnumber">3.2</span> <span class="toctext">Gate Descriptor</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Interrupt_Descriptor_Table#Example_Code_2"><span class="tocnumber">3.3</span> <span class="toctext">Example Code</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="Interrupt_Descriptor_Table#Gate_Types"><span class="tocnumber">4</span> <span class="toctext">Gate Types</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="Interrupt_Descriptor_Table#Interrupt_Gate"><span class="tocnumber">4.1</span> <span class="toctext">Interrupt Gate</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="Interrupt_Descriptor_Table#Trap_Gate"><span class="tocnumber">4.2</span> <span class="toctext">Trap Gate</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="Interrupt_Descriptor_Table#Task_Gate"><span class="tocnumber">4.3</span> <span class="toctext">Task Gate</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="Interrupt_Descriptor_Table#See_Also"><span class="tocnumber">5</span> <span class="toctext">See Also</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="Interrupt_Descriptor_Table#Articles"><span class="tocnumber">5.1</span> <span class="toctext">Articles</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="Interrupt_Descriptor_Table#External_References"><span class="tocnumber">5.2</span> <span class="toctext">External References</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="IDTR">IDTR</span></h2>
<p>The location of the <b>IDT</b> is kept in the <b>IDTR</b> (<b>IDT</b> register). This is loaded using the <b>LIDT</b> assembly instruction, whose argument is a pointer to an <b>IDT Descriptor</b> structure:
</p>
<table class="wikitable">
<caption>IDT Descriptor (IDTR):
</caption>
<tbody><tr>
<th style="width: 66%; text-align: left;">79 (64-bit Mode)<br />48 (32-bit Mode)&#160;&#160;&#160;<span style="float: right;">16</span>
</th>
<th style="width: 34%; text-align: left; vertical-align: bottom;">15&#160;&#160;&#160;<span style="float: right;">0</span>
</th></tr>
<tr>
<td><b>Offset</b><br />63 (64-bit Mode)<br />31 (32-bit Mode)&#160;&#160;&#160;<span style="float: right;">0</span>
</td>
<td><b>Size</b><br /><br />15&#160;&#160;&#160;<span style="float: right;">0</span>
</td></tr></tbody></table>
<ul><li><b>Size</b>: One less than the size of the <b>IDT</b> in bytes.</li>
<li><b>Offset</b>: The linear address of the <b>Interrupt Descriptor Table</b> (not the physical address, paging applies).</li></ul>
<p>Note that the amount of data loaded by <b>LIDT</b> differs in 32-bit and 64-bit modes, <b>Offset</b> is 4 bytes long in 32-bit mode and 8 bytes long in 64-bit mode.
</p><p>This is similar to the <b><a href="GDT" class="mw-redirect" title="GDT">GDT</a></b>, except:
</p>
<ul><li>The first entry (at zero offset) is used in the <b>IDT</b>.</li>
<li>There are 256 interrupt vectors (0..255), so the <b>IDT</b> should have 256 entries, each entry corresponding to a specific interrupt vector.</li>
<li>Although the <b>IDT</b> can contain more than 256 entries, they are ignored.</li>
<li>Although the <b>IDT</b> can contain less than 256 entries, any entries that are not present (due to this or other reasons) will generate a <b><a href="Exceptions#General_Protection_Fault" title="Exceptions">General Protection Fault</a></b> when an attempt to access them is made. Ideally the <b>IDT</b> should contain enough entries so that this fault (which is itself an interrupt vector) can be handled.</li></ul>
<p>For more information, see <b>Section 2.4.3: IDTR Interrupt Descriptor Table Register</b> and <b>Figure 2-6: Memory Management Registers</b> of the Intel Software Developer Manual, Volume 3-A.
</p>
<h2><span class="mw-headline" id="Structure_on_IA-32">Structure on IA-32</span></h2>
<h3><span class="mw-headline" id="Table">Table</span></h3>
<p>On 32-bit processors, the entries in the <b>IDT</b> are 8 bytes long and form a table like this:
</p>
<table class="wikitable">
<caption>Interrupt Descriptor Table (32-bit)
</caption>
<tbody><tr>
<th>Address</th>
<th>Content
</th></tr>
<tr>
<td>IDTR Offset + 0</td>
<td>Entry 0
</td></tr>
<tr>
<td>IDTR Offset + 8</td>
<td>Entry 1
</td></tr>
<tr>
<td>IDTR Offset + 16</td>
<td>Entry 2
</td></tr>
<tr style="text-align: center;">
<td><b>...</b></td>
<td><b>...</b>
</td></tr>
<tr>
<td>IDTR Offset + 2040</td>
<td>Entry 255
</td></tr></tbody></table>
<p>The corresponding entry for a given <b>Interrupt Vector</b> is pointed to in memory by scaling the vector by 8 and adding it to the value in the <b>Offset</b> field of the <b>IDTR</b>.
</p>
<h3><span class="mw-headline" id="Gate_Descriptor">Gate Descriptor</span></h3>
<p>Each entry in the table has a complex structure:
</p>
<table class="wikitable">
<caption>Gate Descriptor (32-bit):
</caption>
<tbody><tr>
<th style="width: 50%; text-align: left;">63&#160;&#160;&#160;<span style="float: right;">48</span>
</th>
<th style="width: 3.125%">47
</th>
<th style="width: 6.25%; text-align: left;">46&#160;&#160;&#160;<span style="float: right;">45</span>
</th>
<th style="width: 3.125%">44
</th>
<th style="width: 12.5%; text-align: left;">43&#160;&#160;&#160;<span style="float: right;">40</span>
</th>
<th style="width: 25%; text-align: left;">39&#160;&#160;&#160;<span style="float: right;">32</span>
</th></tr>
<tr>
<td><b>Offset</b><br />31&#160;&#160;&#160;<span style="float: right;">16</span>
</td>
<td style="text-align: center; vertical-align: top;"><b>P</b>
</td>
<td><b>DPL</b><br />1&#160;&#160;&#160;<span style="float: right;">0</span>
</td>
<td style="text-align: center; vertical-align: top;">0
</td>
<td><b>Gate Type</b><br />3&#160;&#160;&#160;<span style="float: right;">0</span>
</td>
<td style="vertical-align:top">Reserved
</td></tr>
<tr>
<th style="text-align: left;">31&#160;&#160;&#160;<span style="float: right;">16</span>
</th>
<th style="text-align: left;" colspan="5">15&#160;&#160;&#160;<span style="float: right;">0</span>
</th></tr>
<tr>
<td><b>Segment Selector</b><br />15&#160;&#160;&#160;<span style="float: right;">0</span>
</td>
<td colspan="5"><b>Offset</b><br />15&#160;&#160;&#160;<span style="float: right;">0</span>
</td></tr></tbody></table>
<ul><li><b>Offset:</b> A 32-bit value, split in two parts. It represents the address of the entry point of the <b><a href="Interrupt_Service_Routines" title="Interrupt Service Routines">Interrupt Service Routine</a></b>.</li>
<li><b>Selector:</b> A <b><a href="Segment_Selector" title="Segment Selector">Segment Selector</a></b> with multiple fields which must point to a valid code segment in your <b><a href="GDT" class="mw-redirect" title="GDT">GDT</a></b>.</li>
<li><b>Gate Type:</b> A 4-bit value which defines the type of gate this <b>Interrupt Descriptor</b> represents. There are five valid type values:
<ul><li><b>0b0101</b> or <b>0x5</b>: Task Gate, note that in this case, the <b>Offset</b> value is unused and should be set to zero.</li>
<li><b>0b0110</b> or <b>0x6</b>: 16-bit Interrupt Gate</li>
<li><b>0b0111</b> or <b>0x7</b>: 16-bit Trap Gate</li>
<li><b>0b1110</b> or <b>0xE</b>: 32-bit Interrupt Gate</li>
<li><b>0b1111</b> or <b>0xF</b>: 32-bit Trap Gate</li></ul></li>
<li><b>DPL:</b> A 2-bit value which defines the <b><a href="Security#Rings" title="Security">CPU Privilege Levels</a></b> which are allowed to access this interrupt via the <b>INT</b> instruction. Hardware interrupts ignore this mechanism.</li>
<li><b>P:</b> Present bit. Must be set (<b>1</b>) for the descriptor to be valid.</li></ul>
<p>For more information, see <b>Section 6.11: IDT Descriptors</b> and <b>Figure 6-2: IDT Gate Descriptors</b> of the <a rel="nofollow" class="external text" href="https://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-software-developer-vol-3a-part-1-manual.html">Intel Software Developer Manual, Volume 3-A</a>.
</p>
<h3><span class="mw-headline" id="Example_Code">Example Code</span></h3>
<p>C Struct:
</p>
<div class="mw-highlight mw-highlight-lang-c mw-content-ltr" dir="ltr"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">InterruptDescriptor32</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">offset_1</span><span class="p">;</span><span class="w">        </span><span class="c1">// offset bits 0..15</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">selector</span><span class="p">;</span><span class="w">        </span><span class="c1">// a code segment selector in GDT or LDT</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w">  </span><span class="n">zero</span><span class="p">;</span><span class="w">            </span><span class="c1">// unused, set to 0</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w">  </span><span class="n">type_attributes</span><span class="p">;</span><span class="w"> </span><span class="c1">// gate type, dpl, and p fields</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">offset_2</span><span class="p">;</span><span class="w">        </span><span class="c1">// offset bits 16..31</span>
<span class="p">};</span><span class="w"></span>
</pre></div>
<p>Example <i>type_attributes</i> values that people are likely to use (assuming DPL is 0):
</p>
<ul><li>32-bit <b>Interrupt Gate: 0x8E</b> (p=1, dpl=0b00, type=0b1110 =&gt; type_attributes=0b1000_1110=<b>0x8E</b>)</li>
<li>32-bit <b>Trap Gate: 0x8F</b> (p=1, dpl=0b00, type=0b1111 =&gt; type_attributes=1000_1111b=<b>0x8F</b>)</li>
<li><b>Task Gate: 0x85</b> (p=1, dpl=0b00, type=0b0101 =&gt; type_attributes=0b1000_0101=<b>0x85</b>)</li></ul>
<h2><span class="mw-headline" id="Structure_on_x86-64">Structure on x86-64</span></h2>
<h3><span class="mw-headline" id="Table_2">Table</span></h3>
<p>On 64-bit processors, the entries in the <b>IDT</b> are 16 bytes long and form a table like this:
</p>
<table class="wikitable">
<caption>Interrupt Descriptor Table (64-bit)
</caption>
<tbody><tr>
<th>Address</th>
<th>Content
</th></tr>
<tr>
<td>IDTR Offset + 0</td>
<td>Entry 0
</td></tr>
<tr>
<td>IDTR Offset + 16</td>
<td>Entry 1
</td></tr>
<tr>
<td>IDTR Offset + 32</td>
<td>Entry 2
</td></tr>
<tr style="text-align: center;">
<td><b>...</b></td>
<td><b>...</b>
</td></tr>
<tr>
<td>IDTR Offset + 4080</td>
<td>Entry 255
</td></tr></tbody></table>
<p>The corresponding entry for a given <b>Interrupt Vector</b> is pointed to in memory by scaling the vector by 16 and adding it to the value in the <b>Offset</b> field of the <b>IDTR</b>.
</p>
<h3><span class="mw-headline" id="Gate_Descriptor_2">Gate Descriptor</span></h3>
<p>Each entry in the table has a complex structure:
</p>
<table class="wikitable">
<caption>Gate Descriptor (64-bit):
</caption>
<tbody><tr>
<th colspan="7" style="text-align: left;">127&#160;&#160;&#160;<span style="float: right;">96</span>
</th></tr>
<tr>
<td colspan="7">Reserved
</td></tr>
<tr>
<th colspan="7" style="text-align: left;">95&#160;&#160;&#160;<span style="float: right;">64</span>
</th></tr>
<tr>
<td colspan="7"><b>Offset</b><br />63&#160;&#160;&#160;<span style="float: right;">32</span>
</td></tr>
<tr>
<th style="width: 50%; text-align: left;">63&#160;&#160;&#160;<span style="float: right;">48</span>
</th>
<th style="width: 3.125%">47
</th>
<th style="width: 6.25%; text-align: left;">46&#160;&#160;&#160;<span style="float: right;">45</span>
</th>
<th style="width: 3.125%">44
</th>
<th style="width: 12.5%; text-align: left;">43&#160;&#160;&#160;<span style="float: right;">40</span>
</th>
<th style="width: 15.625%; text-align: left;">39&#160;&#160;&#160;<span style="float: right;">35</span>
</th>
<th style="width: 9.375%; text-align: left;">34&#160;&#160;&#160;<span style="float: right;">32</span>
</th></tr>
<tr>
<td><b>Offset</b><br />31&#160;&#160;&#160;<span style="float: right;">16</span>
</td>
<td style="text-align: center; vertical-align: top;"><b>P</b>
</td>
<td><b>DPL</b><br />1&#160;&#160;&#160;<span style="float: right;">0</span>
</td>
<td style="text-align: center; vertical-align: top;">0
</td>
<td><b>Gate Type</b><br />3&#160;&#160;&#160;<span style="float: right;">0</span>
</td>
<td style="vertical-align:top">Reserved
</td>
<td><b>IST</b><br />2&#160;&#160;&#160;<span style="float: right;">0</span>
</td></tr>
<tr>
<th style="text-align: left;">31&#160;&#160;&#160;<span style="float: right;">16</span>
</th>
<th style="text-align: left;" colspan="6">15&#160;&#160;&#160;<span style="float: right;">0</span>
</th></tr>
<tr>
<td><b>Segment Selector</b><br />15&#160;&#160;&#160;<span style="float: right;">0</span>
</td>
<td colspan="6"><b>Offset</b><br />15&#160;&#160;&#160;<span style="float: right;">0</span>
</td></tr></tbody></table>
<ul><li><b>Offset:</b> A 64-bit value, split in three parts. It represents the address of the entry point of the <b><a href="Interrupt_Service_Routines" title="Interrupt Service Routines">Interrupt Service Routine</a></b>.</li>
<li><b>Selector:</b> A <b><a href="Segment_Selector" title="Segment Selector">Segment Selector</a></b> with multiple fields which must point to a valid code segment in your <b><a href="GDT" class="mw-redirect" title="GDT">GDT</a></b>.</li>
<li><b>IST:</b> A 3-bit value which is an offset into the <b>Interrupt Stack Table</b>, which is stored in the <b><a href="Task_State_Segment" title="Task State Segment">Task State Segment</a></b>. If the bits are all set to zero, the <b>Interrupt Stack Table</b> is not used.</li>
<li><b>Gate Type:</b> A 4-bit value which defines the type of gate this <b>Interrupt Descriptor</b> represents. In long mode there are two valid type values:
<ul><li><b>0b1110</b> or <b>0xE</b>: 64-bit Interrupt Gate</li>
<li><b>0b1111</b> or <b>0xF</b>: 64-bit Trap Gate</li></ul></li>
<li><b>DPL:</b> A 2-bit value which defines the <b><a href="Security#Rings" title="Security">CPU Privilege Levels</a></b> which are allowed to access this interrupt via the <b>INT</b> instruction. Hardware interrupts ignore this mechanism.</li>
<li><b>P:</b> Present bit. Must be set (<b>1</b>) for the descriptor to be valid.</li></ul>
<p>In your <b><a href="Interrupt_Service_Routines" title="Interrupt Service Routines">Interrupt Service Routines</a></b>, remember to return from the interrupt using the <b>IRETQ</b> instruction instead of <b>IRET</b>, as assemblers will not translate that for you. Many 64-bit IDT related problems on the forum are caused by that missing 'Q'. Don't let this happen to you.
</p><p>For more information, see <b>Section 6.14.1: 64-Bit Mode IDT</b> and <b>Figure 6-8: 64-Bit IDT Gate Descriptors</b> of the Intel Software Developer Manual, Volume 3-A.
</p>
<h3><span class="mw-headline" id="Example_Code_2">Example Code</span></h3>
<p>C Struct:
</p>
<div class="mw-highlight mw-highlight-lang-c mw-content-ltr" dir="ltr"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">InterruptDescriptor64</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">offset_1</span><span class="p">;</span><span class="w">        </span><span class="c1">// offset bits 0..15</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">selector</span><span class="p">;</span><span class="w">        </span><span class="c1">// a code segment selector in GDT or LDT</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w">  </span><span class="n">ist</span><span class="p">;</span><span class="w">             </span><span class="c1">// bits 0..2 holds Interrupt Stack Table offset, rest of bits zero.</span>
<span class="w">   </span><span class="kt">uint8_t</span><span class="w">  </span><span class="n">type_attributes</span><span class="p">;</span><span class="w"> </span><span class="c1">// gate type, dpl, and p fields</span>
<span class="w">   </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">offset_2</span><span class="p">;</span><span class="w">        </span><span class="c1">// offset bits 16..31</span>
<span class="w">   </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">offset_3</span><span class="p">;</span><span class="w">        </span><span class="c1">// offset bits 32..63</span>
<span class="w">   </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">zero</span><span class="p">;</span><span class="w">            </span><span class="c1">// reserved</span>
<span class="p">};</span><span class="w"></span>
</pre></div>
<p>Example <i>type_attributes</i> values that people are likely to use (assuming DPL is 0):
</p>
<ul><li>64-bit <b>Interrupt Gate: 0x8E</b> (p=1, dpl=0b00, type=0b1110 =&gt; type_attributes=0b1000_1110=<b>0x8E</b>)</li>
<li>64-bit <b>Trap Gate: 0x8F</b> (p=1, dpl=0b00, type=0b1111 =&gt; type_attributes=1000_1111b=<b>0x8F</b>)</li></ul>
<h2><span class="mw-headline" id="Gate_Types">Gate Types</span></h2>
<p>There are basically two kinds of interrupts: ones that occur when code execution has encountered an <b><a href="Exceptions" title="Exceptions">Exception</a></b> due to bad code, or ones that occur to handle events unrelated to currently executing code. In the first case it is pertinent to save the address of the <i>currently</i> executing instruction so that it can be retried, these are called <b>Traps</b>. In the second case it is pertinent to save the address of the <i>next</i> instruction so that execution can be resumed where it left off. These could be caused by an IRQ or other hardware event, or by use of the <b>INT</b> instruction. Another difference to note is that with <b>Traps</b>, new interrupts might occur during the service routine, but when the CPU is serving an IRQ, further interrupts are masked until an <b>End of Interrupt</b> signal is sent. How a certain interrupt is served depends on which kind of gate you put in the IDT entry.
</p>
<h3><span class="mw-headline" id="Interrupt_Gate">Interrupt Gate</span></h3>
<p>An <b>Interrupt Gate</b> is used to specify an <b><a href="Interrupt_Service_Routines" title="Interrupt Service Routines">Interrupt Service Routine</a></b>. For example, when the assembly instruction <b>INT 50</b> is performed while running in protected mode, the CPU looks up the 50th entry (located at 50 * 8) in the <b>IDT</b>. Then the Interrupt Gate's <b>Selector</b> and <b>Offset</b> values are loaded. The <b>Selector</b> and <b>Offset</b> are used to call the <b>Interrupt Service Routine</b>. When the <b>IRET</b> instruction is performed, the CPU returns from the interrupt. If the CPU was running in 32-bit mode and the specified selector is a 16-bit gate, then the CPU will go in 16-bit Protected Mode after calling the <b>ISR</b>. To return in this case, the <b>O32 IRET</b> instruction should be used, or else the CPU will not know that it should do a 32-bit return (reading 32-bit values off the <a href="Stack" title="Stack">stack</a> instead of 16 bit).
</p>
<h3><span class="mw-headline" id="Trap_Gate">Trap Gate</span></h3>
<p>A <b>Trap Gate</b> should be used to handle <b><a href="Exceptions" title="Exceptions">Exceptions</a></b>. When such an exception occurs, there can sometimes be an error code placed on the stack, which should be popped before returning from the interrupt.
</p><p><b>Trap Gates</b> and <b>Interrupt Gates</b> are similar, and their descriptors are structurally the same, differing only in the <b>Gate Type</b> field. The difference is that for <b>Interrupt Gates</b>, interrupts are automatically disabled upon entry and reenabled upon <b>IRET</b>, whereas this does not occur for <b>Trap Gates</b>.
</p>
<h3><span class="mw-headline" id="Task_Gate">Task Gate</span></h3>
<p>A <b>Task Gate</b> is a gate type specific to IA-32 that is used for hardware task switching. For a <b>Task Gate</b> the <b>Selector</b> value should refer to a position in the <b><a href="GDT" class="mw-redirect" title="GDT">GDT</a></b> which specifies a <b><a href="Task_State_Segment" title="Task State Segment">Task State Segment</a></b> rather than a code segment, and the <b>Offset</b> value is unused and should be set to zero. Rather than jumping to a service routine, when the CPU processes this interrupt, it will perform a hardware task switch to the specified task. A pointer back to the task which was interrupted will be stored in the <b>Task Link</b> field in the <b>TSS</b>.
</p>
<table class="toccolours" align="center" width="75%" style="padding: 20px 30px 10px 10px;">

<tbody><tr>
<td>
<div class="scroll">"*NOTE* Because IA-32 tasks are not re-entrant, an interrupt-handler task must disable interrupts between the time it completes handling the interrupt and the time it executes the IRET instruction. This action prevents another interrupt from occurring while the interrupt task's TSS is still marked busy, which would cause a general-protection (#GP) exception."</div>
<p style="text-align: right;">
—Intel Software Developer Manual
</p>
</td></tr></tbody></table>
<p>This type of gate is not often used as hardware task switching is slow and has little to no optimization on modern processors. As well, it has been entirely removed on <a href="X86-64" title="X86-64">x86-64</a>.
</p>
<h2><span class="mw-headline" id="See_Also">See Also</span></h2>
<h3><span class="mw-headline" id="Articles">Articles</span></h3>
<ul><li><a href="GDT" class="mw-redirect" title="GDT">GDT</a></li>
<li><a href="IDT_problems" class="mw-redirect" title="IDT problems">IDT problems</a></li></ul>
<h3><span class="mw-headline" id="External_References">External References</span></h3>
<ul><li><a rel="nofollow" class="external text" href="http://www.logix.cz/michal/doc/i386/chp09-00.htm">Michal Ludvig's Intel 80386 Programmer's Reference Manual chapter 9</a></li></ul>
<!-- 
NewPP limit report
Cached time: 20250211122316
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.028 seconds
Real time usage: 0.029 seconds
Preprocessor visited node count: 140/1000000
Post‐expand include size: 623/2097152 bytes
Template argument size: 525/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 3394/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    1.578      1 Template:Quotation
100.00%    1.578      1 -total
 51.52%    0.813      1 Template:If
 22.37%    0.353      1 Template:Show1
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:1545-0!canonical and timestamp 20250211122316 and revision id 29121.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.osdev.org/index.php?title=Interrupt_Descriptor_Table&amp;oldid=29121">https://wiki.osdev.org/index.php?title=Interrupt_Descriptor_Table&amp;oldid=29121</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="./Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="https://wiki.osdev.org/index.php?title=Category:Pages_using_deprecated_source_tags&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages using deprecated source tags (page does not exist)">Pages using deprecated source tags</a></li><li><a href="./Category:X86_CPU" title="Category:X86 CPU">X86 CPU</a></li><li><a href="./Category:Interrupts" title="Category:Interrupts">Interrupts</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-login" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Special:UserLogin&amp;returnto=Interrupt+Descriptor+Table" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li><li id="pt-darkmode" class="mw-list-item"><a href="Interrupt_Descriptor_Table#" class="ext-darkmode-link"><span>Dark mode</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="Interrupt_Descriptor_Table" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="mw-list-item"><a href="./Talk:Interrupt_Descriptor_Table" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="Interrupt_Descriptor_Table"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Interrupt_Descriptor_Table&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Interrupt_Descriptor_Table&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://wiki.osdev.org/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search OSDev Wiki" aria-label="Search OSDev Wiki" autocapitalize="sentences" title="Search OSDev Wiki [f]" accesskey="f" id="searchInput"
				>
				<input type="hidden" name="title" value="Special:Search">
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="index.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage" class="mw-list-item"><a href="index.html" title="Visit the main page [z]" accesskey="z"><span>Main Page</span></a></li><li id="n-portal" class="mw-list-item"><a href="http://forum.osdev.org/" rel="nofollow" title="About the project, what you can do, where to find things"><span>Forums</span></a></li><li id="n-FAQ" class="mw-list-item"><a href="./Category:FAQ"><span>FAQ</span></a></li><li id="n-OS-Projects" class="mw-list-item"><a href="Projects"><span>OS Projects</span></a></li><li id="n-randompage" class="mw-list-item"><a href="https://wiki.osdev.org/Special:Random" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-about" class="vector-menu mw-portlet mw-portlet-about vector-menu-portal portal" aria-labelledby="p-about-label" role="navigation"  >
	<h3
		id="p-about-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">About</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-This-site" class="mw-list-item"><a href="./OSDevWiki:About"><span>This site</span></a></li><li id="n-Joining" class="mw-list-item"><a href="./OSDevWiki:Joining"><span>Joining</span></a></li><li id="n-Editing-help" class="mw-list-item"><a href="./OSDevWiki:Editing"><span>Editing help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="./Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li></ul>
		
	</div>
</nav>


<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="./Special:WhatLinksHere/Interrupt_Descriptor_Table" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="https://wiki.osdev.org/Special:RecentChangesLinked/Interrupt_Descriptor_Table" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="./Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Interrupt_Descriptor_Table&amp;oldid=29121" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Interrupt_Descriptor_Table&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-lang" class="vector-menu mw-portlet mw-portlet-lang vector-menu-portal portal" aria-labelledby="p-lang-label" role="navigation"  >
	<h3
		id="p-lang-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">In other languages</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li class="interlanguage-link interwiki-de mw-list-item"><a href="http://www.lowlevel.eu/wiki/Interrupt_Descriptor_Table" title="Interrupt Descriptor Table – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li></ul>
		
	</div>
</nav>

</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 8 June 2024, at 11:35.</li>
	<li id="footer-info-0">This page has been accessed 41,072 times.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="./OSDev_Wiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="./OSDev_Wiki:About">About OSDev Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="./OSDev_Wiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://wiki.osdev.org/index.php?title=Interrupt_Descriptor_Table&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.028","walltime":"0.029","ppvisitednodes":{"value":140,"limit":1000000},"postexpandincludesize":{"value":623,"limit":2097152},"templateargumentsize":{"value":525,"limit":2097152},"expansiondepth":{"value":7,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":3394,"limit":5000000},"timingprofile":["100.00%    1.578      1 Template:Quotation","100.00%    1.578      1 -total"," 51.52%    0.813      1 Template:If"," 22.37%    0.353      1 Template:Show1"]},"cachereport":{"timestamp":"20250211122316","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":111});});</script>
</body>
</html>