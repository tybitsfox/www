<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Raspberry Pi - OSDev Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"8bbef7682cc71d8882075e4e","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Raspberry_Pi","wgTitle":"Raspberry Pi","wgCurRevisionId":28444,"wgRevisionId":28444,"wgArticleId":3306,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages using deprecated source tags","In Progress","Articles Written in First Person","ARM","Raspberry Pi"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Raspberry_Pi","wgRelevantArticleId":3306,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[]
,"wgRestrictionMove":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"nearby":false,"watchlist":false,"tagline":false},"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgVector2022PreviewPages":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgEditSubmitButtonLabelPublish":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.DarkMode.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","mmv.head","mmv.bootstrap.autostart","ext.DarkMode","ext.moderation.notify","ext.moderation.ve","ext.moderation.ajaxhook","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=ext.DarkMode.styles%7Cext.pygments%7Cext.visualEditor.desktopArticleTarget.noscript%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://wiki.osdev.org/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.39.7"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="OSDev Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="OSDev Wiki Atom feed" href="https://wiki.osdev.org/index.php?title=Special:RecentChanges&amp;feed=atom"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Raspberry_Pi rootpage-Raspberry_Pi skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Raspberry Pi</span></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From OSDev Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="Raspberry_Pi#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="Raspberry_Pi#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><center>
<table style="border: 1px solid #cfcfbf; margin-top: 25px; margin-bottom: 25px; background-color: #f0f0ff; text-align: center;">
<tbody><tr>
<td>
<p><a href="./File:Under_Construction.png" class="image" title="This page is under construction!"><img alt="This page is under construction!" src="images/1/14/Under_Construction.png" decoding="async" width="50" height="50" data-file-width="50" data-file-height="50" /></a>
This page or section is a work in progress and may thus be incomplete. Its content may be changed in the near future.
</p>
</td>
<td>
</td></tr></tbody></table>
</center>
<center>
<table style="border: 1px solid #cfcfbf; margin-top: 25px; margin-bottom: 25px; background-color: #f0f0ff; text-align: center;">
<tbody><tr>
<td>
<p>This page or section refers to its readers or editors using <i>I</i>, <i>my</i>, <i>we</i> or <i>us</i>. It should be <a rel="nofollow" class="external text" href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;action=edit">edited</a> to be in an encyclopedic tone.
</p>
</td></tr></tbody></table>
</center>
<center>
<table style="border: 1px solid #cfcfbf; margin-top: 25px; margin-bottom: 25px; background-color: #f0f0ff; text-align: center;">
<tbody><tr>
<td>
<p>This article was written like there is only one author. This is a wiki, not a personal site. You can help the wiki by <a rel="nofollow" class="external text" href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;action=edit">editing</a> this article to remove mentions of authors.
</p>
</td></tr></tbody></table>
</center>
<p>This is a tutorial on bare-metal [OS] development on the Raspberry Pi. This tutorial is written specifically for the Raspberry Pi Model B Rev 2 because the author has no other hardware to test on. But so far the models are basically identical for the purpose of this tutorial (Rev 1 has 256MB ram, Model A has no ethernet).
</p><p>This is the authors very first ARM system and we learn as we write without any prior knowledge about ARM. Experience in Linux/Unix (<b>very</b> important) and C/C++ language (<b>incredibly</b> important, including how to use inline assembler) is assumed and required. This is not a tutorial about how to build a kernel but a simple intro in how to get started on the RPi.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Raspberry_Pi#Preparations"><span class="tocnumber">1</span> <span class="toctext">Preparations</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="Raspberry_Pi#Materials"><span class="tocnumber">1.1</span> <span class="toctext">Materials</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="Raspberry_Pi#Serial_adaptor"><span class="tocnumber">1.2</span> <span class="toctext">Serial adaptor</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="Raspberry_Pi#Testing_your_hardware/serial_port"><span class="tocnumber">1.3</span> <span class="toctext">Testing your hardware/serial port</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="Raspberry_Pi#Building_a_cross_compiler"><span class="tocnumber">1.4</span> <span class="toctext">Building a cross compiler</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="Raspberry_Pi#Tutorials_and_examples"><span class="tocnumber">2</span> <span class="toctext">Tutorials and examples</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="Raspberry_Pi#Booting_the_kernel"><span class="tocnumber">3</span> <span class="toctext">Booting the kernel</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="Raspberry_Pi#Boot_from_serial"><span class="tocnumber">4</span> <span class="toctext">Boot from serial</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="Raspberry_Pi#Raspbootin_serial_protocol"><span class="tocnumber">4.1</span> <span class="toctext">Raspbootin serial protocol</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="Raspberry_Pi#Parsing_ATAGs"><span class="tocnumber">5</span> <span class="toctext">Parsing ATAGs</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="Raspberry_Pi#Framebuffer_support"><span class="tocnumber">6</span> <span class="toctext">Framebuffer support</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="Raspberry_Pi#Interrupts_and_exceptions"><span class="tocnumber">7</span> <span class="toctext">Interrupts and exceptions</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="Raspberry_Pi#Floating_point_support"><span class="tocnumber">8</span> <span class="toctext">Floating point support</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="Raspberry_Pi#USB"><span class="tocnumber">9</span> <span class="toctext">USB</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="Raspberry_Pi#External_references"><span class="tocnumber">10</span> <span class="toctext">External references</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Preparations">Preparations</span></h2>
<h3><span class="mw-headline" id="Materials">Materials</span></h3>
<p>You will need a:
</p>
<ul><li><b>Raspberry Pi</b>, RPi in short.</li>
<li><a href="SD_Card" class="mw-redirect" title="SD Card">SD Card</a> to boot from.</li>
<li>A SD Card reader so you can write to the SD Card from your developement system.</li>
<li>A serial adaptor for the RPi.</li>
<li>Power from an external Power Supply, USB or the Serial Adaptor.</li></ul>
<h3><span class="mw-headline" id="Serial_adaptor">Serial adaptor</span></h3>
<p>The RPi has 2 serial ports (<a href="UART" title="UART">UARTs</a>). This tutorial only concerns itself with UART0, called simply UART or serial port. UART1 is ignored from now on. The basic UART onboard uses a 3.3V TTL and is connected to some of the GPIO pins labeled "P1" on the board. x86 PCs and MACs do use 5V TTL so you need some adaptor to convert the TTL. A <b>USB to TTL Serial Cable - Debug/Console Cable for Raspberry Pi</b> with separate connectors per lead, like <a rel="nofollow" class="external text" href="http://www.adafruit.com/products/954">commercial RPi serial adaptor</a>, is recommended.. Which is then connected to the RPi <a href="images/3/36/ARM_RaspberryPi_serial.jpg" class="internal" title="ARM RaspberryPi serial.jpg">like this</a>. The slightly cheaper <a rel="nofollow" class="external text" href="http://www.ebay.com/itm/USB-To-RS232-TTL-PL2303HX-Auto-Converter-Module-Converter-Adapter-5V-3-3V-Output-/350568364250">PL2303HX adapter</a> was found usable, but seems to be unreliable if connected to an USB port with an extension cable (a USB 2.0 hub might remedy this).
</p><p>Note: The serial adaptor I use provides both a 0V and 5V lead (black and red) which provide power to the RPi. No extra power supply is needed besides this.
</p><p>Alternatively, you can use the FTDI chip on an Arduino (or clone thereof). Connect RX on the Arduino to RX on the Pi, TX to TX and GND to GND, then connect the Arduino's reset pin to ground to prevent code in flash from interfering. Due to reset being held low, the Arduino itself is entirely bypassed. If you have a clone that supports 3.3V operation (such as a Seeeduino) then you can enable it to be safe, but this approach works fine with 5V.
</p>
<h3><span id="Testing_your_hardware.2Fserial_port"></span><span class="mw-headline" id="Testing_your_hardware/serial_port">Testing your hardware/serial port</span></h3>
<p>First things first, you're going to want to make sure all your hardware works. Connect your serial adaptor to the RPi and boot up the official Raspian image. The boot process will output to both the serial and the HDMI and will start a getty on the serial.  Set up your serial port, however yours works, and open up minicom. Make sure you have flow control turned off.
Ensure you can run at 115200 baud, 8N1, which is what the RPi uses.
</p><p>If you get 'Permission Denied' <b>do NOT become root!</b> This is unnecessary. Instead do:
</p>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span>sudo adduser &lt;user&gt; dialout
</pre></div>
<p>This will let your user use serial ports without needing root.
</p><p>Or do ls -l /dev/ttyS* to find out the group that own the device, then add you into that group under /etc/group (normally the group is uucp)
</p><p>If you started minicom only after the RPi has booted then simply press <b>return</b> in minicom so the getty will output a fresh login prompt. Otherwise wait for the boot messages to appear. If you don't get any output then connect the RPi to a monitor to check that it actually boots, check your connections and minicom settings.
</p>
<h3><span class="mw-headline" id="Building_a_cross_compiler">Building a cross compiler</span></h3>
<p>Like me you are probably using a x86 PC as main machine and want to edit and compile the source on that and the RPi is an ARM CPU so you absolutely need a cross compiler. But even if you are developing on an ARM system it is still a good idea to build a cross compiler to avoid accidentally mixing stuff from your developement system with your own kernel. Follow the steps from <a href="GCC_Cross-Compiler" title="GCC Cross-Compiler">GCC Cross-Compiler</a> to build your own cross compiler but use:
</p>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">export</span> <span class="nv">TARGET</span><span class="o">=</span>arm-none-eabi
</pre></div>
<p>Now you are ready to start.
</p>
<h2><span class="mw-headline" id="Tutorials_and_examples">Tutorials and examples</span></h2>
<ol><li><a rel="nofollow" class="external text" href="https://www.cl.cam.ac.uk/projects/raspberrypi/tutorials/os/">Tutorial in assembler (University of Cambridge)</a></li>
<li><a href="Raspberry_Pi_Bare_Bones" title="Raspberry Pi Bare Bones">Tutorial in C</a></li>
<li><a href="Raspberry_Pi_Bare_Bones_Rust" title="Raspberry Pi Bare Bones Rust">Tutorial in Rust</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/dwelch67/raspberrypi">Collection of examples and bootloader by dwelch67</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/bztsrc/raspi3-tutorial">Tutorials for AArch64 in C by bzt</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/s-matyukevich/raspberry-pi-os">OS tutorial for the Raspberry Pi by s-matyukevich</a></li>
<li><a href="Detecting_Raspberry_Pi_Board" title="Detecting Raspberry Pi Board">Detecting Raspberry Pi Board</a></li></ol>
<h2><span class="mw-headline" id="Booting_the_kernel">Booting the kernel</span></h2>
<p>Do you still have the SD card with the original Raspian image on it from when you where testing the hardware above? Great. So you already have a SD card with a boot partition and the required files. If not then download one of the original Raspberry boot images and copy them to the SD card.
</p><p>Now mount the first partition from the SD card and look at it:
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>bootcode.bin  fixup.dat     kernel.img            start.elf
cmdline.txt   fixup_cd.dat  kernel_cutdown.img    start_cd.elf
config.txt    issue.txt     kernel_emergency.img
</pre></div>
<p>When the RPi powers up the ARM CPU is halted and the GPU runs. The GPU loads the bootloader from rom and executes it. That then finds the SD card and loads the bootcode.bin. The bootcode handles the config.txt and cmdline.txt (or does start.elf read that?) and then runs start.elf. start.elf loads the kernel.img at 0x00008000, puts a few opcodes at 0x00000000 and the ATAGS at 0x00000100 and at last the ARM CPU is started. The CPU starts executing at 0x00000000, where it will initialize r0, r1 and r2 and jump to 0x00008000 where the kernel image starts.
</p><p>So to boot your own kernel simply replace kernel.img with our own, umount, sync, stick the SD card into RPi and turn the power on.
</p><p>Note: The GPU also initialized the video ouput, detecting the right resolution from the monitor (if hdmi) or from the config.txt and creates a 2x2 pixel framebuffer (red, yellow, blue and cyan pixels) that the hardware scales to fullscreen with color interpolation. So you get rectangle with a nice color fading.
</p>
<h2><span class="mw-headline" id="Boot_from_serial">Boot from serial</span></h2>
<p>The RPi boots the kernel directly from an SD card and only from an SD card. There is no other option. While developing this becomes tiresome since one has to constantly swap the SD card from the RPi to a SD card reader and back. Writing the kernel to the SD card over and over also wears out the card. Plus the SD card slot is somewhat fragile; several people have reported that they broke it accidentally. Overall not an ideal solution. So what can we do about that?
</p><p>I've written a small bootloader named <a rel="nofollow" class="external text" href="https://github.com/mrvn/raspbootin">Raspbootin</a> based on the Tutorial in C above that loads the real kernel from the serial port. Raspbootin is acompanied by Raspbootcom (<a rel="nofollow" class="external text" href="https://github.com/mrvn/raspbootin">same repository</a>) that acts as a boot server and terminal program. Using the two I only need to reboot my RPi to get it to boot the latest kernel. This makes testing both faster and safer for the hardware.
</p><p>Raspbootin is completely transparent for your kernel. It preserves the r0, r1 and r2 registers and ATAGs placed into memory by the GPU for your kernel. So whether you boot your kernel directly from an SD card or with Raspbootin via serial port makes no difference to your code.
</p>
<h3><span class="mw-headline" id="Raspbootin_serial_protocol">Raspbootin serial protocol</span></h3>
<p>You don't have to care about this unless you want to write your own boot server.
</p><p>The boot protocol for Raspbootin is rather simple. Raspbootin first sends 3 breaks (<code>\x03</code>) over the serial line to signal that it is ready to receive a kernel. It then expects the size of the kernel as <code>uint32_t</code> in little endian byte order. After the size it replies with "<code>OK</code>" if the size is acceptable or "<code>SE</code>" if it is too large for it to handle. After "<code>OK</code>" it expects <code>size</code> many bytes representing the kernel. That's it.
</p>
<h2><span class="mw-headline" id="Parsing_ATAGs">Parsing ATAGs</span></h2>
<p>A good documentation for ATAGs can be found <a rel="nofollow" class="external text" href="http://www.simtec.co.uk/products/SWLINUX/files/booting_article.html#appendix_tag_reference">here</a>.
</p><p><a rel="nofollow" class="external text" href="http://web.archive.org/web/20120605001004/http://www.simtec.co.uk/products/SWLINUX/files/booting_article.html">cached version from the Wayback Machine</a>
</p><p>Note that later Raspberry Pis will pass you a device tree blob instead in R2. ATAGs still can be found at 0x100, if you disable device tree (r2 contains 0x0 in this case) - identifiable because they always start with an ATAG_CORE (0x54410001). In comparison, Device Tree is probably far more useful, but is more complex. A device tree starts with the uint32_t 0xd00dfeed <b>(big-endian).</b> Note the big endian - this applies to all values. ARM defaults to little endian, so you'll probably want to write some endian routines early!
<a rel="nofollow" class="external text" href="https://www.devicetree.org/">Device Tree Specification</a>
</p>
<h2><span class="mw-headline" id="Framebuffer_support">Framebuffer support</span></h2>
<p>On boot the RPi configures a display with a virtual resolution of 2x2 pixel scaled to full screen. Each pixel has a different color and the hardware scaling interpolates the colors to show a nice color fade. So before you do anything first connect a monitor and see to it that you get some output.
</p><p>For a framebuffer, you need to learn how to
<a rel="nofollow" class="external text" href="https://github.com/raspberrypi/firmware/wiki/Accessing-mailboxes">access mailboxes</a>. And then you have to send the GPU some <a rel="nofollow" class="external text" href="https://github.com/raspberrypi/firmware/wiki/Mailbox-property-interface">mail</a>. Or, you could read about the framebuffer <a rel="nofollow" class="external text" href="http://elinux.org/RPi_Framebuffer">here</a>,
</p><p>Start with a single simple querry at first and then build up more complex mails. If you get it working then I recommend just altering the virtual size and color depth and leaving the physical resolution as is. The RPi seems to do a fine job of detecting the monitor and the user can also configure a resolution in the boot config files on the SD card. Best to honor his wishes.
</p>
<h2><span class="mw-headline" id="Interrupts_and_exceptions">Interrupts and exceptions</span></h2>
<p>By default the exception vector table on ARM starts at 0x0. You can use that but there are better ways. You can set a flag to use a high vector at 0xffff0000 or set the exception vector base address register to point to your own table anywhere (32 byte aligned) you like.
</p><p>Note: Interrupts are level triggered so you have to clear the source of an interrupt or mask it before returning from interrupt. The ARM CPU in the RPi also supports some extra instructions for storing registers on the stack of a different mode, switching modes and returning from interrupt. Those extensions are nicely described in the ARM arm.
</p><p>Note: The return address in LR during an interrupt will be 0-8 byte, depending on the type of exception, offset to what it should be and needs to be adjusted before returning. Again look into the ARM arm for which offset applies to which exception.
</p><p>Implementing and testing the software interrupt first is a good idea since you can trigger it in a controlled way.
</p><p>When configuring some peripheral to send an interrupt it is a useful thing to have interrupts disabled in the CPSR, enable the interrupt you are interested in (or all) in the 3 interrupt enable registers and then poll the 3 pending registers in a tight loop and output changes. This allows you to see if the peripheral raises an interrupt and (if in doubt) which one. After that the real interrupt handler can be configured and tested. Gives you a nice half way point to test what you have so far.
</p>
<h2><span class="mw-headline" id="Floating_point_support">Floating point support</span></h2>
<p>To be able to use any floating point operations, such as storing or loading floating point numbers, you need to enable the FPU before using it. To do this, you have to enable access to the coprocessor to whoever should be able to use it, and you have to enable the FPU itself.
</p>
<div class="mw-highlight mw-highlight-lang-asm mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># enable FPU in coprocessor enable register - this gives everybody access to both locations of coprocessor.</span>
<span class="nf">ldr</span><span class="w"> </span><span class="no">r0</span><span class="p">,</span><span class="w"> </span><span class="err">=</span><span class="p">(</span><span class="mi">0xF</span><span class="w"> </span><span class="err">&lt;&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"></span>
<span class="nf">mcr</span><span class="w"> </span><span class="no">p15</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="no">r0</span><span class="p">,</span><span class="w"> </span><span class="no">c1</span><span class="p">,</span><span class="w"> </span><span class="no">c0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
</pre></div>
<p>And then enable the FPU itself:
</p>
<div class="mw-highlight mw-highlight-lang-asm mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># enable FPU in FP exception register</span>
<span class="nf">MOV</span><span class="w"> </span><span class="no">r3</span><span class="p">,</span><span class="w"> </span><span class="mi">#0</span><span class="no">x40000000</span><span class="w"></span>
<span class="c1">#  VMSR FPEXC, r3    # assembler bug</span>
<span class="na">.long</span><span class="w"> </span><span class="mi">0xeee83a10</span><span class="w"></span>
</pre></div>
<p>The third line is the actual instruction that you'd want to use, but due to a bug in Binutils 2.23 it does not assemble. The line below it is what it should assemble to, and replaces the opcode. After doing these two, it's possible to use the FPU.
</p>
<h2><span class="mw-headline" id="USB">USB</span></h2>
<p>A standalone BSD-licenced USB driver with support for keyboard and mouse is available here: <a rel="nofollow" class="external free" href="https://github.com/Chadderz121/csud">https://github.com/Chadderz121/csud</a> . This driver can be kept stand-alone, by editing the <code>/source/platform.c</code> file to interface the driver with your implementation of <code>malloc()</code> and similar functions, or you can integrate the driver more closely with your operating system.
</p>
<h2><span class="mw-headline" id="External_references">External references</span></h2>
<ol><li><a rel="nofollow" class="external text" href="https://www.scss.tcd.ie/~waldroj/3d1/arm_arm.pdf">arm_arm.pdf</a> - General ARM Architecture Reference Manual v6</li>
<li><a rel="nofollow" class="external text" href="http://infocenter.arm.com/help/topic/com.arm.doc.ddi0301h/DDI0301H_arm1176jzfs_r0p7_trm.pdf">DDI0301H_arm1176jzfs_r0p7_trm.pdf</a> - More specific ARM for the RPi</li>
<li><a rel="nofollow" class="external text" href="https://github.com/dwelch67/raspberrypi">dwelch67 examples</a> - Basic toolchain + UART stuff</li>
<li><a rel="nofollow" class="external text" href="http://elinux.org/RPi_Hardware">RPi_Hardware</a> - List of datasheets (and one manual about peripherals on the Broadcom chip)</li>
<li><a rel="nofollow" class="external text" href="https://github.com/raspberrypi/firmware/wiki">GitHub Raspberry Pi firmware wiki</a> - For mailboxes and video stuff</li>
<li><a rel="nofollow" class="external text" href="http://www.raspberrypi.org/wp-content/uploads/2012/02/BCM2835-ARM-Peripherals.pdf">BCM2835-ARM-Peripherals.pdf</a> - Datasheet for RPi peripherals</li>
<li><a rel="nofollow" class="external text" href="http://www.simtec.co.uk/products/SWLINUX/files/booting_article.html">Booting ARM Linux</a> - Describes the generic bootloader interface to the ARM port of Linux which the RPi bootloader emulates</li>
<li><a rel="nofollow" class="external text" href="http://sourceforge.net/projects/rpiqemuwindows/">RPi Emulator</a> - A preconfigured QEMU RPi emulation environment for Windows.</li></ol>
<!-- 
NewPP limit report
Cached time: 20250212012236
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.040 seconds
Real time usage: 0.566 seconds
Preprocessor visited node count: 106/1000000
Post‐expand include size: 2104/2097152 bytes
Template argument size: 451/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2464/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    4.563      1 -total
 64.47%    2.942      1 Template:Sole_Editor
 23.10%    1.054      2 Template:NoteBox
 20.99%    0.958      1 Template:FirstPerson
 11.55%    0.527      1 Template:In_Progress
  9.91%    0.452      1 Template:EditThis
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:3306-0!canonical and timestamp 20250212012235 and revision id 28444.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;oldid=28444">https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;oldid=28444</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="./Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="https://wiki.osdev.org/index.php?title=Category:Pages_using_deprecated_source_tags&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages using deprecated source tags (page does not exist)">Pages using deprecated source tags</a></li><li><a href="./Category:In_Progress" title="Category:In Progress">In Progress</a></li><li><a href="./Category:Articles_Written_in_First_Person" title="Category:Articles Written in First Person">Articles Written in First Person</a></li><li><a href="./Category:ARM" title="Category:ARM">ARM</a></li><li><a href="./Category:Raspberry_Pi" title="Category:Raspberry Pi">Raspberry Pi</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-login" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Special:UserLogin&amp;returnto=Raspberry+Pi" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li><li id="pt-darkmode" class="mw-list-item"><a href="Raspberry_Pi#" class="ext-darkmode-link"><span>Dark mode</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="Raspberry_Pi" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="mw-list-item"><a href="./Talk:Raspberry_Pi" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="Raspberry_Pi"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://wiki.osdev.org/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search OSDev Wiki" aria-label="Search OSDev Wiki" autocapitalize="sentences" title="Search OSDev Wiki [f]" accesskey="f" id="searchInput"
				>
				<input type="hidden" name="title" value="Special:Search">
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="index.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage" class="mw-list-item"><a href="index.html" title="Visit the main page [z]" accesskey="z"><span>Main Page</span></a></li><li id="n-portal" class="mw-list-item"><a href="http://forum.osdev.org/" rel="nofollow" title="About the project, what you can do, where to find things"><span>Forums</span></a></li><li id="n-FAQ" class="mw-list-item"><a href="./Category:FAQ"><span>FAQ</span></a></li><li id="n-OS-Projects" class="mw-list-item"><a href="Projects"><span>OS Projects</span></a></li><li id="n-randompage" class="mw-list-item"><a href="https://wiki.osdev.org/Special:Random" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-about" class="vector-menu mw-portlet mw-portlet-about vector-menu-portal portal" aria-labelledby="p-about-label" role="navigation"  >
	<h3
		id="p-about-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">About</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-This-site" class="mw-list-item"><a href="./OSDevWiki:About"><span>This site</span></a></li><li id="n-Joining" class="mw-list-item"><a href="./OSDevWiki:Joining"><span>Joining</span></a></li><li id="n-Editing-help" class="mw-list-item"><a href="./OSDevWiki:Editing"><span>Editing help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="./Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li></ul>
		
	</div>
</nav>


<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="./Special:WhatLinksHere/Raspberry_Pi" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="https://wiki.osdev.org/Special:RecentChangesLinked/Raspberry_Pi" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="./Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;oldid=28444" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 7 November 2023, at 11:33.</li>
	<li id="footer-info-0">This page has been accessed 18,246 times.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="./OSDev_Wiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="./OSDev_Wiki:About">About OSDev Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="./OSDev_Wiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://wiki.osdev.org/index.php?title=Raspberry_Pi&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.040","walltime":"0.566","ppvisitednodes":{"value":106,"limit":1000000},"postexpandincludesize":{"value":2104,"limit":2097152},"templateargumentsize":{"value":451,"limit":2097152},"expansiondepth":{"value":7,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":2464,"limit":5000000},"timingprofile":["100.00%    4.563      1 -total"," 64.47%    2.942      1 Template:Sole_Editor"," 23.10%    1.054      2 Template:NoteBox"," 20.99%    0.958      1 Template:FirstPerson"," 11.55%    0.527      1 Template:In_Progress","  9.91%    0.452      1 Template:EditThis"]},"cachereport":{"timestamp":"20250212012236","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":91});});</script>
</body>
</html>