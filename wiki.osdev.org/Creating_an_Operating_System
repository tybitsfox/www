<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Creating an Operating System - OSDev Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"29718b360893ef717d010509","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Creating_an_Operating_System","wgTitle":"Creating an Operating System","wgCurRevisionId":29373,"wgRevisionId":29373,"wgArticleId":3353,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages using duplicate arguments in template calls","Level 4 Tutorials","OS Development"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Creating_an_Operating_System","wgRelevantArticleId":3353,"wgIsProbablyEditable":false,
"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"nearby":false,"watchlist":false,"tagline":false},"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgVector2022PreviewPages":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgEditSubmitButtonLabelPublish":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","skins.vector.styles.legacy":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.DarkMode.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","mmv.head","mmv.bootstrap.autostart","ext.DarkMode","ext.moderation.notify","ext.moderation.ve","ext.moderation.ajaxhook","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=ext.DarkMode.styles%7Cext.visualEditor.desktopArticleTarget.noscript%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://wiki.osdev.org/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.39.7"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="OSDev Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="OSDev Wiki Atom feed" href="https://wiki.osdev.org/index.php?title=Special:RecentChanges&amp;feed=atom"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Creating_an_Operating_System rootpage-Creating_an_Operating_System skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Creating an Operating System</span></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From OSDev Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="Creating_an_Operating_System#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="Creating_an_Operating_System#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><table style="font-size:95%; line-height:1.5em; padding:0.25em; float:right; margin: 0 0 8px 15px; clear:right; border:1px solid #aaaaaa; background:#eee; text-align:center;;"><tbody><tr><th>Difficulty level</th></tr><tr><td><a href="./File:Difficulty_4.png" class="image"><img alt="Difficulty 4.png" src="images/a/a3/Difficulty_4.png" decoding="async" width="46" height="14" data-file-width="46" data-file-height="14" /></a><br />Master</td></tr></tbody></table>
<p>Welcome to operating systems development! This tutorial will document the process of creating a new operating system from the baby steps to creating a self-hosting operating system. The path is long and hard, but also fun and rewarding. As you progress through the stages, you will slowly begin to diverge from the tutorial as you make your own decisions about the design of your operating system and you no longer need this guide. If you create a non-Unix-like operating system, you will diverge earlier and will have to fill in the missing gaps yourself.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Creating_an_Operating_System#Phase_0:_Introduction"><span class="tocnumber">1</span> <span class="toctext">Phase 0: Introduction</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="Creating_an_Operating_System#Welcome_to_Operating_Systems_Development"><span class="tocnumber">1.1</span> <span class="toctext">Welcome to Operating Systems Development</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="Creating_an_Operating_System#Building_the_latest_GCC"><span class="tocnumber">1.2</span> <span class="toctext">Building the latest GCC</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="Creating_an_Operating_System#Phase_I:_Beginning"><span class="tocnumber">2</span> <span class="toctext">Phase I: Beginning</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="Creating_an_Operating_System#Setting_up_a_Cross-Toolchain"><span class="tocnumber">2.1</span> <span class="toctext">Setting up a Cross-Toolchain</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="Creating_an_Operating_System#Creating_a_Hello_World_kernel"><span class="tocnumber">2.2</span> <span class="toctext">Creating a Hello World kernel</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="Creating_an_Operating_System#Setting_up_a_Project"><span class="tocnumber">2.3</span> <span class="toctext">Setting up a Project</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Creating_an_Operating_System#Calling_Global_Constructors"><span class="tocnumber">2.4</span> <span class="toctext">Calling Global Constructors</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Creating_an_Operating_System#Terminal_Support"><span class="tocnumber">2.5</span> <span class="toctext">Terminal Support</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="Creating_an_Operating_System#Stack_Smash_Protector"><span class="tocnumber">2.6</span> <span class="toctext">Stack Smash Protector</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="Creating_an_Operating_System#Multiboot"><span class="tocnumber">2.7</span> <span class="toctext">Multiboot</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="Creating_an_Operating_System#Global_Descriptor_Table"><span class="tocnumber">2.8</span> <span class="toctext">Global Descriptor Table</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="Creating_an_Operating_System#Memory_Management"><span class="tocnumber">2.9</span> <span class="toctext">Memory Management</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="Creating_an_Operating_System#Interrupts"><span class="tocnumber">2.10</span> <span class="toctext">Interrupts</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="Creating_an_Operating_System#Multithreaded_Kernel"><span class="tocnumber">2.11</span> <span class="toctext">Multithreaded Kernel</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="Creating_an_Operating_System#Keyboard"><span class="tocnumber">2.12</span> <span class="toctext">Keyboard</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="Creating_an_Operating_System#Internal_Kernel_Debugger"><span class="tocnumber">2.13</span> <span class="toctext">Internal Kernel Debugger</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="Creating_an_Operating_System#Filesystem_Support"><span class="tocnumber">2.14</span> <span class="toctext">Filesystem Support</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19"><a href="Creating_an_Operating_System#Phase_II:_User-Space"><span class="tocnumber">3</span> <span class="toctext">Phase II: User-Space</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="Creating_an_Operating_System#User-Space"><span class="tocnumber">3.1</span> <span class="toctext">User-Space</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="Creating_an_Operating_System#Program_Loading"><span class="tocnumber">3.2</span> <span class="toctext">Program Loading</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="Creating_an_Operating_System#System_Calls"><span class="tocnumber">3.3</span> <span class="toctext">System Calls</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="Creating_an_Operating_System#OS_Specific_Toolchain"><span class="tocnumber">3.4</span> <span class="toctext">OS Specific Toolchain</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="Creating_an_Operating_System#Creating_a_C_Library"><span class="tocnumber">3.5</span> <span class="toctext">Creating a C Library</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="Creating_an_Operating_System#Fork_and_Execute"><span class="tocnumber">3.6</span> <span class="toctext">Fork and Execute</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="Creating_an_Operating_System#Shell"><span class="tocnumber">3.7</span> <span class="toctext">Shell</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27"><a href="Creating_an_Operating_System#Phase_III:_Extending_your_Operating_System"><span class="tocnumber">4</span> <span class="toctext">Phase III: Extending your Operating System</span></a>
<ul>
<li class="toclevel-2 tocsection-28"><a href="Creating_an_Operating_System#Time"><span class="tocnumber">4.1</span> <span class="toctext">Time</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="Creating_an_Operating_System#Threads"><span class="tocnumber">4.2</span> <span class="toctext">Threads</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="Creating_an_Operating_System#Thread_Local_Storage"><span class="tocnumber">4.3</span> <span class="toctext">Thread Local Storage</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="Creating_an_Operating_System#Symmetric_Multiprocessing"><span class="tocnumber">4.4</span> <span class="toctext">Symmetric Multiprocessing</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="Creating_an_Operating_System#Secondary_Storage"><span class="tocnumber">4.5</span> <span class="toctext">Secondary Storage</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="Creating_an_Operating_System#Real_Filesystems"><span class="tocnumber">4.6</span> <span class="toctext">Real Filesystems</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="Creating_an_Operating_System#Graphics"><span class="tocnumber">4.7</span> <span class="toctext">Graphics</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="Creating_an_Operating_System#User_Interface"><span class="tocnumber">4.8</span> <span class="toctext">User Interface</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="Creating_an_Operating_System#Networking"><span class="tocnumber">4.9</span> <span class="toctext">Networking</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="Creating_an_Operating_System#Sound"><span class="tocnumber">4.10</span> <span class="toctext">Sound</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="Creating_an_Operating_System#Universal_Serial_Bus"><span class="tocnumber">4.11</span> <span class="toctext">Universal Serial Bus</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39"><a href="Creating_an_Operating_System#Phase_IV:_Bootstrapping"><span class="tocnumber">5</span> <span class="toctext">Phase IV: Bootstrapping</span></a>
<ul>
<li class="toclevel-2 tocsection-40"><a href="Creating_an_Operating_System#Porting_Software"><span class="tocnumber">5.1</span> <span class="toctext">Porting Software</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="Creating_an_Operating_System#Porting_GCC"><span class="tocnumber">5.2</span> <span class="toctext">Porting GCC</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="Creating_an_Operating_System#Compiling_your_OS_under_your_OS"><span class="tocnumber">5.3</span> <span class="toctext">Compiling your OS under your OS</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="Creating_an_Operating_System#Fully_Self-hosting"><span class="tocnumber">5.4</span> <span class="toctext">Fully Self-hosting</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-44"><a href="Creating_an_Operating_System#Phase_V:_Profit"><span class="tocnumber">6</span> <span class="toctext">Phase V: Profit</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Phase_0:_Introduction">Phase 0: Introduction</span></h2>
<h3><span class="mw-headline" id="Welcome_to_Operating_Systems_Development">Welcome to Operating Systems Development</span></h3>
<dl><dd><i>Main article:</i> <a href="Introduction" title="Introduction">Introduction</a></dd></dl>
<p>You should consult all the basic documentation before starting writing an operating system.
</p>
<h3><span class="mw-headline" id="Building_the_latest_GCC">Building the latest GCC</span></h3>
<dl><dd><i>Main article:</i> <a href="Building_GCC" title="Building GCC">Building GCC</a></dd></dl>
<p>You may wish to upgrade your system compiler to the latest version before you start out with operating systems development and build the cross-compiler.
</p>
<h2><span class="mw-headline" id="Phase_I:_Beginning">Phase I: Beginning</span></h2>
<p>In this phase we will set up a toolchain and create a basic kernel that will become the core of the new operating system.
</p>
<h3><span class="mw-headline" id="Setting_up_a_Cross-Toolchain">Setting up a Cross-Toolchain</span></h3>
<dl><dd><i>Main article:</i> <a href="GCC_Cross_Compiler" class="mw-redirect" title="GCC Cross Compiler">GCC Cross Compiler</a></dd></dl>
<p>The first thing you will like to do is set up a cross-compiler for your operating system. The compiler on your local system is not able to produce programs for your operating system because it hasn't been invented yet. At first you would like to do is create a compiler that produces executables that will run directly on your target hardware.
</p>
<h3><span class="mw-headline" id="Creating_a_Hello_World_kernel">Creating a Hello World kernel</span></h3>
<dl><dd><i>Main article:</i> <a href="Bare_Bones" title="Bare Bones">Bare Bones</a></dd>
<dd><i>See also <a href="./Category:Bare_bones_tutorials" title="Category:Bare bones tutorials">Bare Bones for other platforms</a></i></dd></dl>
<p>Your next task is to make a simple hello world kernel that is able to start up, print a message to the output device and then loop endlessly. While simple and useless, it will serve as a great example and starting point for a real system, as well as confirm that your testing environment works correctly.
</p>
<h3><span class="mw-headline" id="Setting_up_a_Project">Setting up a Project</span></h3>
<dl><dd><i>Main article:</i> <a href="Meaty_Skeleton" title="Meaty Skeleton">Meaty Skeleton</a></dd></dl>
<p>With a basic working example, your next task is to set up a build infrastructure using whatever build system you see fit. Be careful in your choices of technology, GNU Make is easier to port than Python.
</p>
<h3><span class="mw-headline" id="Calling_Global_Constructors">Calling Global Constructors</span></h3>
<dl><dd><i>Main article:</i> <a href="Calling_Global_Constructors" title="Calling Global Constructors">Calling Global Constructors</a></dd></dl>
<p>The compiler expects you to perform various program initialization tasks, such as calling the constructors on global C++ objects. Normally you would use a <tt>kernel_early_main</tt> function to set up the minimal kernel features, then perform all these initialization tasks, and then jump to the actual <tt>kernel_main</tt> function.
</p>
<h3><span class="mw-headline" id="Terminal_Support">Terminal Support</span></h3>
<dl><dd><i>Main article:</i> <a href="Formatted_Printing" title="Formatted Printing">Formatted Printing</a></dd></dl>
<p>You will often need to debug your operating system. Your very best friend is a printf function that is able to print strings and integers to the screen onto a terminal-like buffer. It is crucial to add a printf function to your kernel early on as you will certainly need it later for debugging.
</p>
<h3><span class="mw-headline" id="Stack_Smash_Protector">Stack Smash Protector</span></h3>
<dl><dd><i>Main article:</i> <a href="Stack_Smashing_Protector" title="Stack Smashing Protector">Stack Smashing Protector</a></dd></dl>
<p>Early is not too soon to think about security and robustness. You can take advantage of the optional stack smash protector offered by modern compilers that detect stack buffer overruns rather than behaving unexpectedly (or nothing happening, if unlucky).
</p>
<h3><span class="mw-headline" id="Multiboot">Multiboot</span></h3>
<dl><dd><i>Main article:</i> <a href="Multiboot" title="Multiboot">Multiboot</a></dd></dl>
<p>It's useful to know what features and information the bootloader offers the kernel, as this may help you get memory maps, set video modes, and even kernel symbol tables.
</p>
<h3><span class="mw-headline" id="Global_Descriptor_Table">Global Descriptor Table</span></h3>
<dl><dd><i>Main article:</i> <a href="Global_Descriptor_Table" title="Global Descriptor Table">Global Descriptor Table</a></dd></dl>
<p>The Global Descriptor Table is an important part of the processor state and it should as such be one of the first things that are initialized. It probably makes a lot of sense to set up it even prior to kernel_early.
</p>
<h3><span class="mw-headline" id="Memory_Management">Memory Management</span></h3>
<dl><dd><i>Main article:</i> <a href="Memory_Management" class="mw-redirect" title="Memory Management">Memory Management</a></dd></dl>
<p>Memory allocation and management is one of the most basic functions in an operating system. You need to keep track of physical page frames, what ranges of virtual memory are used, and implementing a heap (malloc, free) upon it for internal kernel use.
</p>
<h3><span class="mw-headline" id="Interrupts">Interrupts</span></h3>
<dl><dd><i>Main article:</i> <a href="Interrupts" title="Interrupts">Interrupts</a></dd></dl>
<p>Your kernel needs to handle asynchronous events sent by the hardware to function properly.
</p>
<h3><span class="mw-headline" id="Multithreaded_Kernel">Multithreaded Kernel</span></h3>
<dl><dd><i>Main article:</i> <a href="Multithreaded_Kernel" title="Multithreaded Kernel">Multithreaded Kernel</a></dd></dl>
<p>It is best to go multithreaded early in the development of your kernel or you'll end up rewriting parts of your kernel. We'll certainly need this when we add processes later on.
</p>
<h3><span class="mw-headline" id="Keyboard">Keyboard</span></h3>
<dl><dd><i>Main article:</i> <a href="Keyboard" class="mw-redirect" title="Keyboard">Keyboard</a></dd></dl>
<p>Your operating system will certainly need support for reading input from the computer operator so it can adapt its behavior to their wishes.
</p>
<h3><span class="mw-headline" id="Internal_Kernel_Debugger">Internal Kernel Debugger</span></h3>
<dl><dd><i>Main article:</i> <a href="Internal_Kernel_Debugger" title="Internal Kernel Debugger">Internal Kernel Debugger</a></dd></dl>
<p>It is very useful for a multithreaded kernel to have built-in debugging facilities early on. You could have a magic key that stops the entire kernel and dumps the user to a mini-shell for debugging. It could know the data structures used by the scheduler to list all the threads and perform call traces, provide debugging info and so on.
</p>
<h3><span class="mw-headline" id="Filesystem_Support">Filesystem Support</span></h3>
<dl><dd><i>Main articles: <a href="Filesystem" class="mw-redirect" title="Filesystem">Filesystem</a>, <a href="Initrd" title="Initrd">Initialization Ramdisk</a></i></dd></dl>
<p>It'll be useful to have support for filesystems early on and transferring files onto your operating system using an initialization ramdisk.
</p>
<h2><span class="mw-headline" id="Phase_II:_User-Space">Phase II: User-Space</span></h2>
<p>In this phase we'll expand your operating system into user-space and add support for programs, which is enough for your project to qualify as a small operating system. You need to work on system calls, program loading, memory management and rework parts of your system early in this phase.
</p>
<h3><span class="mw-headline" id="User-Space">User-Space</span></h3>
<dl><dd><i>Main article:</i> <a href="https://wiki.osdev.org/index.php?title=User-Space&amp;action=edit&amp;redlink=1" class="new" title="User-Space (page does not exist)">User-Space</a></dd></dl>
<p>Your procesessor has until now run in kernel mode, where the code is able to do everything. Processes are normally run with no permissions at all, except being able to execute code and use its designated memory. The first part of implementing user-space is switching the processor to user mode.
</p>
<h3><span class="mw-headline" id="Program_Loading">Program Loading</span></h3>
<dl><dd><i>Main article:</i> <a href="Dynamic_Linker" title="Dynamic Linker">Dynamic Linker</a></dd></dl>
<p>The first task you will need to complete is loading a program into memory. This involves parsing the program headers, allocating memory at the right virtual addresses and copying the contents of the segments to the right virtual addresses. You'll also need to fill up entries in the GOT according to the relocation tables.
</p>
<h3><span class="mw-headline" id="System_Calls">System Calls</span></h3>
<dl><dd><i>Main article:</i> <a href="System_Calls" title="System Calls">System Calls</a></dd></dl>
<p>You are now able to load programs into memory and switch to user mode. Processes communicate with the kernel using system calls, which is the next feature you will want to add.
</p>
<h3><span class="mw-headline" id="OS_Specific_Toolchain">OS Specific Toolchain</span></h3>
<dl><dd><i>Main article:</i> <a href="OS_Specific_Toolchain" title="OS Specific Toolchain">OS Specific Toolchain</a></dd></dl>
<p>As your operating system is now becoming a real operating system, it is time to treat it as such. We'll like to teach the cross-compiler about your operating system and its conventions, so we can easily cross-compile programs.
</p>
<h3><span class="mw-headline" id="Creating_a_C_Library">Creating a C Library</span></h3>
<dl><dd><i>Main article:</i> <a href="Creating_a_C_Library" title="Creating a C Library">Creating a C Library</a></dd></dl>
<p>At this point, you can decide to use an existing C library or write your own C library. If you go the custom route, you will want to set up some basic features that the cross-compiler needs for libgcc. With this in place, you can now easily cross-compile programs.
</p>
<h3><span class="mw-headline" id="Fork_and_Execute">Fork and Execute</span></h3>
<dl><dd><i>Main article:</i> <a href="https://wiki.osdev.org/index.php?title=Fork&amp;action=edit&amp;redlink=1" class="new" title="Fork (page does not exist)">Fork</a></dd></dl>
<p>With basic program loading in place, we are almost ready to create a multitasking operating system. The missing primitives is allowing a process to create new processes. The standard Unix primitive is fork, which allows a process to create a perfect copy of itself. This copy is then able to call the program loader and replace its own memory with that of another program image.
</p>
<h3><span class="mw-headline" id="Shell">Shell</span></h3>
<dl><dd><i>Main article:</i> <a href="Shell" class="mw-redirect" title="Shell">Shell</a></dd></dl>
<p>This is a very exciting point in your operating system. It is able to run programs and create new processes. So far, the behavior of the system has possibly been determined when it was compiled. By writing a shell, you can run multiple programs and decide which one to run at runtime. This is the point where you reach the level that many newcomers dream of: a basic operating system with a working command line.
</p>
<h2><span class="mw-headline" id="Phase_III:_Extending_your_Operating_System">Phase III: Extending your Operating System</span></h2>
<p>With these basic features in place, you can now start writing your operating system and all its wonderful features. You'll add games, editors, test programs, command line utilties, drivers and whatever you can imagine. Your skill and imagination is the limit here. You can delay many of these features until later in your operating system and make then in almost any order.
</p>
<h3><span class="mw-headline" id="Time">Time</span></h3>
<dl><dd><i>Main article:</i> <a href="Time" class="mw-redirect" title="Time">Time</a></dd></dl>
<p>Time is a complicated concept in computing, however modern operating systems are expected to have functions for converting timestamps to parsed time and back, as well as providing system clocks (real time, monotonic time, user CPU time, ..) and timers on these clocks with events happening on expiration.
</p>
<h3><span class="mw-headline" id="Threads">Threads</span></h3>
<dl><dd><i>Main article:</i> <a href="Thread" title="Thread">Thread</a></dd></dl>
<p>Operating systems should expose a threading API such as pthreads.
</p>
<h3><span class="mw-headline" id="Thread_Local_Storage">Thread Local Storage</span></h3>
<dl><dd><i>Main article:</i> <a href="Thread_Local_Storage" title="Thread Local Storage">Thread Local Storage</a></dd></dl>
<p>Thread local variables require runtime support.
</p>
<h3><span class="mw-headline" id="Symmetric_Multiprocessing">Symmetric Multiprocessing</span></h3>
<dl><dd><i>Main article:</i> <a href="SMP" class="mw-redirect" title="SMP">SMP</a></dd></dl>
<p>It's a very good idea to add support for multiple CPUs to your kernel early on, or you will likely need to redo a lot of your kernel because it wasn't SMP-ready in many places.
</p>
<h3><span class="mw-headline" id="Secondary_Storage">Secondary Storage</span></h3>
<dl><dd><i>Main article:</i> <a href="https://wiki.osdev.org/index.php?title=Secondary&amp;action=edit&amp;redlink=1" class="new" title="Secondary (page does not exist)">Secondary</a></dd></dl>
<p>You will likely want to support common block devices such as harddisks, cdroms, floppies, and whatever storage devices your operating system needs support for.
</p>
<h3><span class="mw-headline" id="Real_Filesystems">Real Filesystems</span></h3>
<dl><dd><i>Main article:</i> <a href="File_Systems" title="File Systems">File Systems</a></dd></dl>
<p>It's a good idea to add proper filesystem support early on.
</p>
<h3><span class="mw-headline" id="Graphics">Graphics</span></h3>
<dl><dd><i>Main article:</i> <a href="How_do_I_set_a_graphics_mode" title="How do I set a graphics mode">How do I set a graphics mode</a></dd></dl>
<p>Real operating systems don't operate in the basic text mode, but have bitmapped graphics. Writing real graphics drivers is a bunch of work, although some virtual machines offer some useful shortcuts.
</p>
<h3><span class="mw-headline" id="User_Interface">User Interface</span></h3>
<dl><dd><i>Main articles</i>: <a href="User_Interface" title="User Interface">User Interface</a>, <a href="Compositing" title="Compositing">Compositing</a></dd></dl>
<p>You will certainly need to impress the operating systems development community with your flashy graphics and usable user-interface.
</p>
<h3><span class="mw-headline" id="Networking">Networking</span></h3>
<dl><dd><i>Main article:</i> <a href="Networking" class="mw-redirect" title="Networking">Networking</a></dd></dl>
<p>The uses for networking support are obvious, so you will likely want to do this.
</p>
<h3><span class="mw-headline" id="Sound">Sound</span></h3>
<dl><dd><i>Main article:</i> <a href="Sound" title="Sound">Sound</a></dd></dl>
<p>Sound is an important part of the computing experience and depending on your needs, you may well wish to support sound on common hardware.
</p>
<h3><span class="mw-headline" id="Universal_Serial_Bus">Universal Serial Bus</span></h3>
<dl><dd><i>Main article:</i> <a href="USB" class="mw-redirect" title="USB">USB</a></dd></dl>
<p>If you need to communicate with modern peripherals, you will likely need a USB stack and support for the various common USB controllers.
</p>
<h2><span class="mw-headline" id="Phase_IV:_Bootstrapping">Phase IV: Bootstrapping</span></h2>
<p>You now have your basic operating system in place and you are ready to move onto the next level. In this phase, we will start porting software onto your operating system such that you can become self-hosting. You already begun your effort toward being self-hosting when you set up your OS-specific toolchain and it pays off now.
</p>
<h3><span class="mw-headline" id="Porting_Software">Porting Software</span></h3>
<dl><dd><i>Main article:</i> <a href="Cross-Porting_Software" title="Cross-Porting Software">Cross-Porting Software</a></dd></dl>
<p>While not all pieces of software is easy to port, most Unix software comes with a autoconf-generated configure script. You can provide these scripts with the --host=mycpu-myos option and if your operating system offers the needed features, you can cross-compile the software onto your operating system. You already met examples of how to port software when setting up the OS-specific toolchain. While the difficulity of cross-compiling software differs greatly, you will like be using the same process for adapting new packages.
</p>
<h3><span class="mw-headline" id="Porting_GCC">Porting GCC</span></h3>
<dl><dd><i>Main article:</i> <a href="Porting_GCC_to_your_OS" title="Porting GCC to your OS">Porting GCC to your OS</a></dd></dl>
<p>You already began the work porting binutils and gcc when you set up the OS-specific toolchain. We'll finish the process and cross-compile them onto your operating system such that it can compile the C hello world program.
</p>
<h3><span class="mw-headline" id="Compiling_your_OS_under_your_OS">Compiling your OS under your OS</span></h3>
<p>The next task is to port your entire build system. You may need to port GNU Make, port some command line utilites (coreutils) or write your own, port a real shell or finish yours and more. You may also need to fix a number of bugs in your operating system such that the compiler runs correctly. You will need to deal with how to transfer the newly compiled version onto permanent storage such that a reboot of the computer will run the next version. Your operating system will now quality as self-compiling.
</p>
<h3><span class="mw-headline" id="Fully_Self-hosting">Fully Self-hosting</span></h3>
<p>Now that you can build your entire operating system under your operating system, you also need to be able to do the rest. You need to be able to also build your compiler under your operating system. You need to be able to develop under your operating system, so you'll port your favorite text editor or write one. You need networking so you can release the newest version (build on itself) onto the internet. You'll port lots of programs, libraries, games, and whatever else you desire, such that the entire development process can happen on your operating system. You can now uninstall your original operating system and replace it with your new glorious operating system.
</p>
<h2><span class="mw-headline" id="Phase_V:_Profit">Phase V: Profit</span></h2>
<p>You have now successfully created a real operating system that is fully self-hosting and the envy of the entire operating systems development community. You have ported quake, have OpenGL programs, a working browser, a thriving community of contributors, and much success. You can now start over and develop the next operating system from your own operating system.
</p>
<!-- 
NewPP limit report
Cached time: 20250211121757
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.039 seconds
Real time usage: 0.040 seconds
Preprocessor visited node count: 455/1000000
Post‐expand include size: 1610/2097152 bytes
Template argument size: 542/2097152 bytes
Highest expansion depth: 23/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    7.215      1 -total
 75.86%    5.473      4 Template:If
 67.87%    4.897      1 Template:Rating
 66.97%    4.832      4 Template:Show1
 16.70%    1.205      4 Template:Eq
 13.00%    0.938     34 Template:Main
  7.42%    0.535      4 Template:Eq1
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:3353-0!canonical and timestamp 20250211121757 and revision id 29373.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.osdev.org/index.php?title=Creating_an_Operating_System&amp;oldid=29373">https://wiki.osdev.org/index.php?title=Creating_an_Operating_System&amp;oldid=29373</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="./Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="https://wiki.osdev.org/index.php?title=Category:Pages_using_duplicate_arguments_in_template_calls&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages using duplicate arguments in template calls (page does not exist)">Pages using duplicate arguments in template calls</a></li><li><a href="./Category:Level_4_Tutorials" title="Category:Level 4 Tutorials">Level 4 Tutorials</a></li><li><a href="./Category:OS_Development" title="Category:OS Development">OS Development</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-login" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Special:UserLogin&amp;returnto=Creating+an+Operating+System" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li><li id="pt-darkmode" class="mw-list-item"><a href="Creating_an_Operating_System#" class="ext-darkmode-link"><span>Dark mode</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="Creating_an_Operating_System" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Talk:Creating_an_Operating_System&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="Creating_an_Operating_System"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Creating_an_Operating_System&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Creating_an_Operating_System&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://wiki.osdev.org/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search OSDev Wiki" aria-label="Search OSDev Wiki" autocapitalize="sentences" title="Search OSDev Wiki [f]" accesskey="f" id="searchInput"
				>
				<input type="hidden" name="title" value="Special:Search">
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="index.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage" class="mw-list-item"><a href="index.html" title="Visit the main page [z]" accesskey="z"><span>Main Page</span></a></li><li id="n-portal" class="mw-list-item"><a href="http://forum.osdev.org/" rel="nofollow" title="About the project, what you can do, where to find things"><span>Forums</span></a></li><li id="n-FAQ" class="mw-list-item"><a href="./Category:FAQ"><span>FAQ</span></a></li><li id="n-OS-Projects" class="mw-list-item"><a href="Projects"><span>OS Projects</span></a></li><li id="n-randompage" class="mw-list-item"><a href="https://wiki.osdev.org/Special:Random" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-about" class="vector-menu mw-portlet mw-portlet-about vector-menu-portal portal" aria-labelledby="p-about-label" role="navigation"  >
	<h3
		id="p-about-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">About</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-This-site" class="mw-list-item"><a href="./OSDevWiki:About"><span>This site</span></a></li><li id="n-Joining" class="mw-list-item"><a href="./OSDevWiki:Joining"><span>Joining</span></a></li><li id="n-Editing-help" class="mw-list-item"><a href="./OSDevWiki:Editing"><span>Editing help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="./Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li></ul>
		
	</div>
</nav>


<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="./Special:WhatLinksHere/Creating_an_Operating_System" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="https://wiki.osdev.org/Special:RecentChangesLinked/Creating_an_Operating_System" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="./Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Creating_an_Operating_System&amp;oldid=29373" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Creating_an_Operating_System&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 5 February 2025, at 22:41.</li>
	<li id="footer-info-0">This page has been accessed 29,637 times.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="./OSDev_Wiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="./OSDev_Wiki:About">About OSDev Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="./OSDev_Wiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://wiki.osdev.org/index.php?title=Creating_an_Operating_System&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.039","walltime":"0.040","ppvisitednodes":{"value":455,"limit":1000000},"postexpandincludesize":{"value":1610,"limit":2097152},"templateargumentsize":{"value":542,"limit":2097152},"expansiondepth":{"value":23,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%    7.215      1 -total"," 75.86%    5.473      4 Template:If"," 67.87%    4.897      1 Template:Rating"," 66.97%    4.832      4 Template:Show1"," 16.70%    1.205      4 Template:Eq"," 13.00%    0.938     34 Template:Main","  7.42%    0.535      4 Template:Eq1"]},"cachereport":{"timestamp":"20250211121757","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":152});});</script>
</body>
</html>