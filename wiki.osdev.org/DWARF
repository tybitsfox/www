<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>DWARF - OSDev Wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"339156b5878a6e9399b529e9","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"DWARF","wgTitle":"DWARF","wgCurRevisionId":29103,"wgRevisionId":29103,"wgArticleId":3878,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages using duplicate arguments in template calls","Pages using deprecated source tags","In Progress","Level 2 Tutorials","Debugging"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"DWARF","wgRelevantArticleId":3878,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,
"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgMFDisplayWikibaseDescriptions":{"search":false,"nearby":false,"watchlist":false,"tagline":false},"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgVector2022PreviewPages":[],"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgEditSubmitButtonLabelPublish":false};RLSTATE={"site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.pygments":"ready","skins.vector.styles.legacy":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.DarkMode.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","mediawiki.toc","skins.vector.legacy.js","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","mmv.head","mmv.bootstrap.autostart","ext.DarkMode","ext.moderation.notify","ext.moderation.ve","ext.moderation.ajaxhook","ext.moderation.notify.desktop"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=ext.DarkMode.styles%7Cext.pygments%7Cext.visualEditor.desktopArticleTarget.noscript%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="https://wiki.osdev.org/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="https://wiki.osdev.org/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.39.7"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="OSDev Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="OSDev Wiki Atom feed" href="https://wiki.osdev.org/index.php?title=Special:RecentChanges&amp;feed=atom"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-DWARF rootpage-DWARF skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">DWARF</span></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From OSDev Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="DWARF#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="DWARF#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><center>
<table style="border: 1px solid #cfcfbf; margin-top: 25px; margin-bottom: 25px; background-color: #f0f0ff; text-align: center;">
<tbody><tr>
<td>
<p><a href="./File:Under_Construction.png" class="image" title="This page is under construction!"><img alt="This page is under construction!" src="images/1/14/Under_Construction.png" decoding="async" width="50" height="50" data-file-width="50" data-file-height="50" /></a>
This page or section is a work in progress and may thus be incomplete. Its content may be changed in the near future.
</p>
</td>
<td>
</td></tr></tbody></table>
</center><table style="font-size:95%; line-height:1.5em; padding:0.25em; float:right; margin: 0 0 8px 15px; clear:right; border:1px solid #aaaaaa; background:#eee; text-align:center;;"><tbody><tr><th>Difficulty level</th></tr><tr><td><a href="./File:Difficulty_2.png" class="image"><img alt="Difficulty 2.png" src="images/a/a1/Difficulty_2.png" decoding="async" width="46" height="14" data-file-width="46" data-file-height="14" /></a><br />Medium</td></tr></tbody></table><table style="font-size:95%; line-height:1.5em; padding:0.25em; float:right; margin: 0 0 8px 15px; clear: right; border:1px solid #aaaaaa; background:#eee; text-align:center; width:200px; ;"><tbody><tr><th style="background:#ffce7b; padding:0.3em; font-size:1.1em;"><a href="Executable_Formats" title="Executable Formats">Executable Formats</a></th></tr><tr><th>Microsoft</th></tr><tr><td><div>
<p><b>16 bit:</b><br />
<a href="COM" title="COM">COM</a><br />
<a href="MZ" title="MZ">MZ</a><br />
<a href="NE" title="NE">NE</a><br />
<b>Mixed (16/32 bit):</b><br />
<a href="LE" title="LE">LE</a><br />
<b>32/64 bit:</b><br />
<a href="PE" title="PE">PE</a><br />
<a href="COFF" title="COFF">COFF</a><br />
</p>
</div></td></tr><tr><th>*nix</th></tr><tr><td><div>
<p><a href="A.out" title="A.out">a.out</a><br />
<a href="ELF" title="ELF">ELF</a><br />
</p>
</div></td></tr><tr><th>Apple</th></tr><tr><td><div>
<p><a href="Mach-O" title="Mach-O">Mach-O</a><br />
</p>
</div></td></tr></tbody></table>
<p>When debugging, chances are you will need debugging information. For instance, you can use GCC utility <b>addr2line</b> to convert an address into an actual location in your code, but it is much more convenient if your OS can display a stack trace with as much debugging information as possible, e.g.
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>[0x00106F39] process_command (utils/shell.c at line 270)
[0x001077F3] process_char (utils/shell.c at line 477)
[0x001079ED] shell (utils/shell.c at line 526)
[0x00100DD6] main (kernel/kernel.c at line 84)
</pre></div>
<p>DWARF is a debugging data format designed along with ELF, and allows you to find all that information.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="DWARF#Generating_the_debug_symbols"><span class="tocnumber">1</span> <span class="toctext">Generating the debug symbols</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="DWARF#Relocation"><span class="tocnumber">2</span> <span class="toctext">Relocation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="DWARF#Mapping_an_address_to_a_line_number_(.debug_line_section)"><span class="tocnumber">3</span> <span class="toctext">Mapping an address to a line number (.debug_line section)</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="DWARF#Binary_representation"><span class="tocnumber">3.1</span> <span class="toctext">Binary representation</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="DWARF#Mapping_an_address_to_a_function_(.debug_info_section)"><span class="tocnumber">4</span> <span class="toctext">Mapping an address to a function (.debug_info section)</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="DWARF#The_.debug_abbrev_section"><span class="tocnumber">5</span> <span class="toctext">The .debug_abbrev section</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="DWARF#Binary_representation_2"><span class="tocnumber">5.1</span> <span class="toctext">Binary representation</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="DWARF#LEB128"><span class="tocnumber">6</span> <span class="toctext">LEB128</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="DWARF#See_Also"><span class="tocnumber">7</span> <span class="toctext">See Also</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="DWARF#Articles"><span class="tocnumber">7.1</span> <span class="toctext">Articles</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="DWARF#External_Links"><span class="tocnumber">7.2</span> <span class="toctext">External Links</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Generating_the_debug_symbols">Generating the debug symbols</span></h2>
<p>You will need to pass the <b>-g</b> to GCC and to ld to generate DWARF information. GCC also allows you to specify the exact DWARF version, e.g. <b>gcc -gdwarf-4</b>.
</p><p>Once this is done, running <b>objdump -h</b> on your executable will show several .debug sections. Those are standard ELF sections that you access the same way as any ELF binary. Running <b>objdump -g</b> on your binary will generate a text dump of the debug symbols.
</p>
<h2><span class="mw-headline" id="Relocation">Relocation</span></h2>
<p>The addresses provided by DWARF are the addresses provided by ELF. You should take into account any relocation if any.
</p>
<h2><span id="Mapping_an_address_to_a_line_number_.28.debug_line_section.29"></span><span class="mw-headline" id="Mapping_an_address_to_a_line_number_(.debug_line_section)">Mapping an address to a line number (.debug_line section)</span></h2>
<p>The <b>.debug_line</b> section allows to determine the source code file and line number for a given address in memory. The content is broken down by Compilation Units (CU) representing one main source code file.
</p><p>Each CU has a header:
</p>
<div class="mw-highlight mw-highlight-lang-c mw-content-ltr" dir="ltr"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">header_length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">min_instruction_length</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">default_is_stmt</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int8_t</span><span class="w"> </span><span class="n">line_base</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">line_range</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">opcode_base</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">std_opcode_lengths</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">DebugLineHeader</span><span class="p">;</span><span class="w"></span>
</pre></div>
<p>followed by a list of directories, a list of files (referencing what directory they are in), and a series of line number statements, e.g.
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>  Offset:                      0x11f
  Length:                      103
  DWARF Version:               2
  Prologue Length:             52
  Minimum Instruction Length:  1
  Initial value of &#39;is_stmt&#39;:  1
  Line Base:                   -5
  Line Range:                  14
  Opcode Base:                 13

 Opcodes:
  Opcode 1 has 0 args
  Opcode 2 has 1 args
  Opcode 3 has 1 args
  Opcode 4 has 1 args
  Opcode 5 has 1 args
  Opcode 6 has 0 args
  Opcode 7 has 0 args
  Opcode 8 has 0 args
  Opcode 9 has 1 args
  Opcode 10 has 0 args
  Opcode 11 has 0 args
  Opcode 12 has 1 args

 The Directory Table (offset 0x13a):
  1	kernel
  2	./lib

 The File Name Table (offset 0x148):
  Entry	Dir	Time	Size	Name
  1	1	0	0	heap.c
  2	2	0	0	libc.h

 Line Number Statements:
  [0x0000015d]  Extended opcode 2: set Address to 0x100ad1
  [0x00000164]  Advance Line by 15 to 16
  [0x00000166]  Copy
  [0x00000167]  Special opcode 48: advance Address by 3 to 0x100ad4 and Line by 1 to 17
  [0x00000168]  Special opcode 50: advance Address by 3 to 0x100ad7 and Line by 3 to 20
  ...
</pre></div>
<p>In order to decode the information from <b>.debug_line</b>, you will need to implement a small state machine with a few registers. The most important registers are:
</p>
<ul><li>Address: the address in memory</li>
<li>File: the source code file</li>
<li>Line: the line number in that file (starts at 1)</li></ul>
<p>Each line number statement starts with a 1-byte opcode, optionally followed by an argument. Each opcode tells what state machine register(s) to change:
</p>
<ul><li>Standard opcodes (1 to 12): see section 6.2.5.2 of the <a rel="nofollow" class="external text" href="http://dwarfstd.org/doc/DWARF4.pdf">The DWARF Debugging Information Format</a> to see what those opcodes are doing and what parameters they take</li>
<li>Extended opcodes (0): the next byte is an unsigned LEB128-encoded number that tells how many bytes after that are used by the extended opcode. The byte after that tells the extended opcode number, followed by any argument. See section 6.2.5.3 of the <a rel="nofollow" class="external text" href="http://dwarfstd.org/doc/DWARF4.pdf">The DWARF Debugging Information Format</a></li>
<li>Special opcodes (13 or greater): these are one-character instructions that tell to change the Address and Line registers. If the Address can only increase, note that the Line may decrease. The way to compute this is a bit tricky (see section 6.2.5.1 of the <a rel="nofollow" class="external text" href="http://dwarfstd.org/doc/DWARF4.pdf">The DWARF Debugging Information Format</a>), but relies on the Line Base, Line Range and Opcode base from the header and goes something line this:</li></ul>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>Address += ((Opcode - Opcode base) / Line range) * Min instruction length
Line += Line base + (Opcode - Opcode base)&#160;% Line range
</pre></div>
<p>In the example above, Special opcode 48 (stored in the file as 48 + 13 = 0x3D) tells to increase the Address by 48 / 14 = 3 bytes (thus moving from 0x100ad1 to 0x100ad4) and the Line by -5 + 48&#160;% 14 = 1 (thus moving from 16 to 17)
</p>
<h3><span class="mw-headline" id="Binary_representation">Binary representation</span></h3>
<p>The above CU is store as follows in a 32-bit ELF binary:
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>67 00 00 00   02 00 34 00   00 00 01 01   FB 0E 0D 00
01 01 01 01   00 00 00 01   00 00 01 6B   65 72 6E 65
6C 00 2E 2F   6C 69 62 00   00 68 65 61   70 2E 63 00
01 00 00 6C   69 62 63 2E   68 00 02 00   00 00 00 05
02 D1 0A 10   00 03 0F 01   3D3F...
</pre></div>
<ul><li>0x67000000: the size of the CU (after this)</li>
<li>0x0200: DWARF version</li>
<li>0x34000000: Header Length, which indicates how many bytes after this number does the first opcode start</li>
<li>0x01: Minimum Instruction Length</li>
<li>0x01: Default is_stmt value</li>
<li>0xFB: Line Base (signed int)</li>
<li>0x0E: Line Range</li>
<li>0x0D: Opcode Base</li>
<li>0x00010101 01000000 01000001: the number of arguments for the 12 standard opcodes</li>
<li>0x6B65726E 656C00: "kernel" (first directory)</li>
<li>0x2E2F6C69 6200: "./lib" (second directory)</li>
<li>0x00: end of the directories</li>
<li>0x68656170 2E6300: "heap.c" (first file)</li>
<li>0x010000: Dir=1 ("kernel"), Time=0, Size=0</li>
<li>0x6C696263 2E6800: "libc.h" (second file)</li>
<li>0x020000: Dir=2 ("./lib"), Time=0, Size=0</li>
<li>0x00: end of the files</li>
<li>0x00: Signals an extended opcode</li>
<li>0x05: number of bytes after this used by the extended opcode (unsigned LEB128 encoded)</li>
<li>0x02: Extended opcode 2 (DW_LNE_set_address)</li>
<li>0xD10A1000: opcode argument (address 0x00100ad1)</li>
<li>0x03: Standard opcode 3 (DW_LNS_advance_line)</li>
<li>0x0F: opcode argument, encoded as a signed LEB128 (15)</li>
<li>0x01: Standard opcode 1 (DW_LNS_copy)</li>
<li>0x3D: Special opcode 48 (0x3D - 13 = 48)</li>
<li>0x3F: Special opcode 50</li></ul>
<h2><span id="Mapping_an_address_to_a_function_.28.debug_info_section.29"></span><span class="mw-headline" id="Mapping_an_address_to_a_function_(.debug_info_section)">Mapping an address to a function (.debug_info section)</span></h2>
<p>The <b>.debug_info</b>, allows -among others- to determine the address range occupied by various parts of the code. It is complemented by the <b>.debug_abbrev</b> and <b>.debug_str</b> sections.
</p><p>the <b>.debug_info</b> section is a series of Compilation Units (CU). Each compilation unit starts with a header followed by Debugging Information Entries (DIEs):
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>Contents of the .debug_info section:

  Compilation Unit @ offset 0x0:
   Length:        0x6b7 (32-bit)
   Version:       4
   Abbrev Offset: 0x0
   Pointer Size:  4
 &lt;0&gt;&lt; b&gt;: Abbrev Number: 1 (DW_TAG_compile_unit)
    &lt;c&gt;   DW_AT_producer   &#160;: (indirect string, offset: 0x107): GNU C99 5.3.0 -m32 -mtune=generic -march=pentiumpro -g -std=gnu99 -ffreestanding
    &lt;10&gt;   DW_AT_language   &#160;: 12	(ANSI C99)
    &lt;11&gt;   DW_AT_name       &#160;: (indirect string, offset: 0x1b8): kernel/main.c
    &lt;15&gt;   DW_AT_comp_dir   &#160;: (indirect string, offset: 0x158): /usr/opsys
    &lt;19&gt;   DW_AT_low_pc     &#160;: 0x1002dd
    &lt;1d&gt;   DW_AT_high_pc    &#160;: 0x7f4
    &lt;21&gt;   DW_AT_stmt_list  &#160;: 0x0
 &lt;1&gt;&lt;25&gt;: Abbrev Number: 2 (DW_TAG_typedef)
    &lt;26&gt;   DW_AT_name       &#160;: (indirect string, offset: 0xa5): uint
    &lt;2a&gt;   DW_AT_decl_file  &#160;: 2
    &lt;2b&gt;   DW_AT_decl_line  &#160;: 4
    &lt;2c&gt;   DW_AT_type       &#160;: &lt;0x30&gt;
 &lt;1&gt;&lt;30&gt;: Abbrev Number: 3 (DW_TAG_base_type)
    &lt;31&gt;   DW_AT_byte_size  &#160;: 4
    &lt;32&gt;   DW_AT_encoding   &#160;: 7	(unsigned)
    &lt;33&gt;   DW_AT_name       &#160;: (indirect string, offset: 0x23a): unsigned int
</pre></div>
<p>So the first thing when reading the <b>.debug_info</b> section is to look at the compilation unit header which contains the following fields:
</p>
<ul><li>unit_length: the size of the unit</li>
<li>version: the DWARF version</li>
<li>debug_abbrev_offset: the offset inside the <b>.debug_abbrev</b> table of the DIE schemas for that CU</li>
<li>address_size: the pointer size</li></ul>
<p>The header is followed by a series of DIEs. First first byte of each DIE indicates its type number, followed by its concatenated attributes. All the DIEs of the same type have the same schema within the same CU, but the number of types (and their schema) varies for each CU.
</p><p>So you need to:
</p>
<ul><li>Read the CU header. This will tell you the end of the CU, as well as the Abbrev Offset.
<ul><li>The Abbrev offset is an offset inside the <b>.debug_abbrev</b> section</li>
<li>Read from the <b>.debug_abbrev</b> section the number of DIE types, as well as the schema for each type (see the next section for further information)
<ul><li>The first character of each DIE tells its type. Based on the type you can derive what attribute does the DIE has, and how much space occupies each attribute</li>
<li>If the DIE type tag is DW_TAG_subprogram, then look for the attributes DW_AT_NAME (function name), DW_AT_low_pc (the address where the function starts) and DW_AT_high_pc (the amount of memory occupied by the function)</li></ul></li>
<li>Repeat until you reach the end of the CU</li></ul></li>
<li>Read the next CU header</li>
<li>Repeat until you reach the end of the .debug_info section</li></ul>
<h2><span class="mw-headline" id="The_.debug_abbrev_section">The .debug_abbrev section</span></h2>
<p>This section contains the schema for all the DIE types from the <b>.debug_info</b> section.
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>Contents of the .debug_abbrev section:

  Number TAG (0x0)
   1      DW_TAG_compile_unit    [has children]
    DW_AT_producer     DW_FORM_strp
    DW_AT_language     DW_FORM_data1
    DW_AT_name         DW_FORM_strp
    DW_AT_comp_dir     DW_FORM_strp
    DW_AT_low_pc       DW_FORM_addr
    DW_AT_high_pc      DW_FORM_data4
    DW_AT_stmt_list    DW_FORM_sec_offset
    DW_AT value: 0     DW_FORM value: 0
   2      DW_TAG_typedef    [no children]
    DW_AT_name         DW_FORM_strp
    DW_AT_decl_file    DW_FORM_data1
    DW_AT_decl_line    DW_FORM_data1
    DW_AT_type         DW_FORM_ref4
    DW_AT value: 0     DW_FORM value: 0
   3      DW_TAG_base_type    [no children]
    DW_AT_byte_size    DW_FORM_data1
    DW_AT_encoding     DW_FORM_data1
    DW_AT_name         DW_FORM_strp
    DW_AT value: 0     DW_FORM value: 0
    ...
</pre></div>
<p>The first byte is the type number followed by its tag. The next byte is whether the type has children or not. Then are stored all the attributes for this type as name / type two-bytes pairs followed by 0x0000. See Figure 21 from the <a rel="nofollow" class="external text" href="http://dwarfstd.org/doc/DWARF4.pdf">The DWARF Debugging Information Format</a> for the list of attribute names and their hex codes and Figure 20 for attribute types. The attribute type tells how many bytes will it occupy in the <b>.debug_info</b> section.
</p><p>If most attributes have a fixed size, a few attributes need to have some special handling:
</p>
<ul><li>DW_FORM_string attributes are a small zero-terminated string (so of variable length)</li>
<li>DW_FORM_strp attributes represent the offset inside the <b>.debug_str</b> section of the desired string</li>
<li>DW_FORM_exprloc attributes are multibytes blocks (so of variable length) composed of an unsigned LEB128 number which tells the block length followed by the said block</li></ul>
<p>The list of DIE types for a particular Compilation Unit is over when the next type number is 0.
</p>
<h3><span class="mw-headline" id="Binary_representation_2">Binary representation</span></h3>
<p>The above is encoded as follows:
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>01 11 01 25   0E 13 0B 03   0E 1B 0E 11   01 12 06 10
17 00 00 02   16 00 03 0E   3A 0B 3B 0B   49 13 00 00
03 24 00 0B   0B 3E 0B 03   0E 00 00 04   24 00 0B 0B
...
</pre></div>
<ul><li>0x01 0x11: Type number 1 / DW_TAG_compile_unit</li>
<li>0x01: has children</li>
<li>0x25 0x0E: DW_AT_producer / DW_FORM_strp</li>
<li>0x13 0x0B: DW_AT_language / DW_FORM_data1</li>
<li>...</li>
<li>0x00 0x00: end of Type number 1</li>
<li>0x02 0x16: Type number 2 / DW_TAG_typedef</li>
<li>0x00: no children</li>
<li>...</li>
<li>0x00 0x00: end of Type number n</li>
<li>0x00: end of the schema for that Compilation Unit</li></ul>
<h2><span class="mw-headline" id="LEB128">LEB128</span></h2>
<p>DWARF is sometimes storing data using LEB128 (Little-Endian Base 128), a variable-length compression algorithm. You can find multiple implementations online, whose functions will typically look like this:
</p>
<div class="mw-highlight mw-highlight-lang-c mw-content-ltr" dir="ltr"><pre><span></span><span class="kt">uint32_t</span><span class="w"> </span><span class="nf">decodeULEB128</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="kt">int32_t</span><span class="w"> </span><span class="nf">decodeSLEB128</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
</pre></div>
<p>The above functions take a pointer to a data stream as an argument, return the decoded value (respectively unsigned and signed LEB128) and store in <b>n</b> the number of characters used to decompress the data.
</p>
<h2><span class="mw-headline" id="See_Also">See Also</span></h2>
<h3><span class="mw-headline" id="Articles">Articles</span></h3>
<ul><li><a href="ELF" title="ELF">ELF</a></li></ul>
<h3><span class="mw-headline" id="External_Links">External Links</span></h3>
<ul><li><a rel="nofollow" class="external text" href="http://dwarfstd.org/doc/DWARF4.pdf">The DWARF Debugging Information Format</a></li></ul>
<!-- 
NewPP limit report
Cached time: 20250211135810
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.065 seconds
Real time usage: 1.137 seconds
Preprocessor visited node count: 474/1000000
Post‐expand include size: 2354/2097152 bytes
Template argument size: 974/2097152 bytes
Highest expansion depth: 19/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 8163/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.036      1 -total
 69.53%    6.283     23 Template:If
 53.22%    4.809     23 Template:Show1
 47.89%    4.327      1 Template:File_formats
 43.89%    3.966      1 Template:Rating
 41.21%    3.724      1 Template:SmallNavBox
 10.40%    0.940      3 Template:Eq
  6.83%    0.617      1 Template:In_Progress
  5.06%    0.457      3 Template:Eq1
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:3878-0!canonical and timestamp 20250211135809 and revision id 29103.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.osdev.org/index.php?title=DWARF&amp;oldid=29103">https://wiki.osdev.org/index.php?title=DWARF&amp;oldid=29103</a>"</div></div>
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="./Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="https://wiki.osdev.org/index.php?title=Category:Pages_using_duplicate_arguments_in_template_calls&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages using duplicate arguments in template calls (page does not exist)">Pages using duplicate arguments in template calls</a></li><li><a href="https://wiki.osdev.org/index.php?title=Category:Pages_using_deprecated_source_tags&amp;action=edit&amp;redlink=1" class="new" title="Category:Pages using deprecated source tags (page does not exist)">Pages using deprecated source tags</a></li><li><a href="./Category:In_Progress" title="Category:In Progress">In Progress</a></li><li><a href="./Category:Level_2_Tutorials" title="Category:Level 2 Tutorials">Level 2 Tutorials</a></li><li><a href="./Category:Debugging" title="Category:Debugging">Debugging</a></li></ul></div></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-login" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Special:UserLogin&amp;returnto=DWARF" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li><li id="pt-darkmode" class="mw-list-item"><a href="DWARF#" class="ext-darkmode-link"><span>Dark mode</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="DWARF" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="https://wiki.osdev.org/index.php?title=Talk:DWARF&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="DWARF"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=DWARF&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=DWARF&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="https://wiki.osdev.org/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search OSDev Wiki" aria-label="Search OSDev Wiki" autocapitalize="sentences" title="Search OSDev Wiki [f]" accesskey="f" id="searchInput"
				>
				<input type="hidden" name="title" value="Special:Search">
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="index.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage" class="mw-list-item"><a href="index.html" title="Visit the main page [z]" accesskey="z"><span>Main Page</span></a></li><li id="n-portal" class="mw-list-item"><a href="http://forum.osdev.org/" rel="nofollow" title="About the project, what you can do, where to find things"><span>Forums</span></a></li><li id="n-FAQ" class="mw-list-item"><a href="./Category:FAQ"><span>FAQ</span></a></li><li id="n-OS-Projects" class="mw-list-item"><a href="Projects"><span>OS Projects</span></a></li><li id="n-randompage" class="mw-list-item"><a href="https://wiki.osdev.org/Special:Random" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-about" class="vector-menu mw-portlet mw-portlet-about vector-menu-portal portal" aria-labelledby="p-about-label" role="navigation"  >
	<h3
		id="p-about-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">About</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-This-site" class="mw-list-item"><a href="./OSDevWiki:About"><span>This site</span></a></li><li id="n-Joining" class="mw-list-item"><a href="./OSDevWiki:Joining"><span>Joining</span></a></li><li id="n-Editing-help" class="mw-list-item"><a href="./OSDevWiki:Editing"><span>Editing help</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="./Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li></ul>
		
	</div>
</nav>


<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="./Special:WhatLinksHere/DWARF" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="./Special:RecentChangesLinked/DWARF" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="./Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=DWARF&amp;oldid=29103" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="https://wiki.osdev.org/index.php?title=DWARF&amp;action=info" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 7 June 2024, at 13:39.</li>
	<li id="footer-info-0">This page has been accessed 6,344 times.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="./OSDev_Wiki:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="./OSDev_Wiki:About">About OSDev Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="./OSDev_Wiki:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-mobileview"><a href="https://wiki.osdev.org/index.php?title=DWARF&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.065","walltime":"1.137","ppvisitednodes":{"value":474,"limit":1000000},"postexpandincludesize":{"value":2354,"limit":2097152},"templateargumentsize":{"value":974,"limit":2097152},"expansiondepth":{"value":19,"limit":100},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":8163,"limit":5000000},"timingprofile":["100.00%    9.036      1 -total"," 69.53%    6.283     23 Template:If"," 53.22%    4.809     23 Template:Show1"," 47.89%    4.327      1 Template:File_formats"," 43.89%    3.966      1 Template:Rating"," 41.21%    3.724      1 Template:SmallNavBox"," 10.40%    0.940      3 Template:Eq","  6.83%    0.617      1 Template:In_Progress","  5.06%    0.457      3 Template:Eq1"]},"cachereport":{"timestamp":"20250211135810","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":1258});});</script>
</body>
</html>