<HTML
><HEAD
>

<TITLE
>聚集函数 PostgreSQL 手册</TITLE
><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.64 "><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 8.1 中文文档（PostgreSQL 中国 制作）" HREF="index.html"><LINK REL="UP" TITLE="函数和操作符" HREF="functions.html"><LINK REL="PREVIOUS" TITLE="数组函数和操作符" HREF="functions-array.html"><LINK REL="NEXT" TITLE="子查询表达式" HREF="functions-subquery.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312"><META NAME="creation" CONTENT="2006-01-03T05:00:21"></HEAD
><BODY CLASS="SECT1" ><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR ><TH
COLSPAN="5"
ALIGN="center"
VALIGN="bottom"
>PostgreSQL 8.1 中文文档</TH
></TR
><TR ><TD WIDTH="10%" ALIGN="left" VALIGN="top" ><A HREF="functions-array.html" >Prev</A
></TD
><TD WIDTH="10%" ALIGN="left" VALIGN="top" ><A HREF="functions.html" >Fast Backward</A
></TD
><TD WIDTH="60%" ALIGN="center" VALIGN="bottom" >Chapter 9. 函数和操作符</TD
><TD WIDTH="10%" ALIGN="right" VALIGN="top" ><A HREF="functions.html" >Fast Forward</A
></TD
><TD WIDTH="10%" ALIGN="right" VALIGN="top" ><A HREF="functions-subquery.html" >Next</A
></TD
></TR
></TABLE
><HR size="1" 
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A NAME="FUNCTIONS-AGGREGATE" >9.15. 聚集函数</A
></H1
><A NAME="AEN12892" ></A
><P
>	<I
CLASS="FIRSTTERM"
>聚集函数</I
> 从一套输入值里计算一个结果。
	<A HREF="functions-aggregate.html#FUNCTIONS-AGGREGATE-TABLE" >Table 9-37</A
> 显示了内建聚集函数。
	聚集函数的特殊语法在
	<A HREF="sql-expressions.html#SYNTAX-AGGREGATES" >Section 4.2.7</A
>里解释。请参考 <A HREF="tutorial.html" >Part I</A
>
	获取附加的介绍性信息。
  </P
><DIV
CLASS="TABLE"
><A NAME="FUNCTIONS-AGGREGATE-TABLE" ></A
><P
><B
>Table 9-37. 聚集函数</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><THEAD
><TR ><TH
ALIGN="LEFT"
VALIGN="TOP"
>函数</TH
><TH
ALIGN="LEFT"
VALIGN="TOP"
>参数类型</TH
><TH
ALIGN="LEFT"
VALIGN="TOP"
>返回类型</TH
><TH
ALIGN="LEFT"
VALIGN="TOP"
>描述</TH
></TR
></THEAD
><TBODY
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >	 <A NAME="AEN12912" ></A
>
	<TT
CLASS="FUNCTION"
>avg(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
	</TD
><TD ALIGN="LEFT" VALIGN="TOP" >所有输入值的均值（算术平均）</TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>smallint</TT
>, <TT
CLASS="TYPE"
>int</TT
>,
       <TT
CLASS="TYPE"
>bigint</TT
>, <TT
CLASS="TYPE"
>real</TT
>, <TT
CLASS="TYPE"
>double
       precision</TT
>, <TT
CLASS="TYPE"
>numeric</TT
>, 或 <TT
CLASS="TYPE"
>interval</TT
>.
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >	对于任何整数类型输入，结果都是 <TT
CLASS="TYPE"
>numeric</TT
> 类型。
	对于任何浮点输入，结果都是 <TT
CLASS="TYPE"
>double precision</TT
> 类型。
	否则和输入数据类型相同。
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >	所有输入值的平均（算术平均）。
      </TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >       <A NAME="AEN12932" ></A
>
       <TT
CLASS="FUNCTION"
>bit_and(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>smallint</TT
>, <TT
CLASS="TYPE"
>int</TT
>, <TT
CLASS="TYPE"
>bigint</TT
>, 或者
       <TT
CLASS="TYPE"
>bit</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >	和参数数据类型相同
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >所有非空输入值的按位 AND （与），如果没有，则为空</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >       <A NAME="AEN12945" ></A
>
       <TT
CLASS="FUNCTION"
>bit_or(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>smallint</TT
>, <TT
CLASS="TYPE"
>int</TT
>, <TT
CLASS="TYPE"
>bigint</TT
>, 或者
       <TT
CLASS="TYPE"
>bit</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >	和参数数据类型相同
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >所有非空输入值的按位 OR （或），如果没有，则为空</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >       <A NAME="AEN12958" ></A
>
       <TT
CLASS="FUNCTION"
>bool_and(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>bool</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>bool</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >如果所有输入值都是真，则为真，否则为假</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >       <A NAME="AEN12969" ></A
>
       <TT
CLASS="FUNCTION"
>bool_or(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>bool</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>bool</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >如果至少有一个输入值为真，则为着，否则为假</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" ><TT
CLASS="FUNCTION"
>count(*)</TT
></TD
><TD ALIGN="LEFT" VALIGN="TOP" >&nbsp;</TD
><TD ALIGN="LEFT" VALIGN="TOP" >bigint</TD
><TD ALIGN="LEFT" VALIGN="TOP" >输入值的个数</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" ><TT
CLASS="FUNCTION"
>count</TT
>(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TD
><TD ALIGN="LEFT" VALIGN="TOP" >任意</TD
><TD ALIGN="LEFT" VALIGN="TOP" ><TT
CLASS="TYPE"
>bigint</TT
></TD
><TD ALIGN="LEFT" VALIGN="TOP" >	计算那些 <TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>
	非 NULL 的输入的个数。
      </TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >       <A NAME="AEN12995" ></A
>
       <TT
CLASS="FUNCTION"
>every(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>bool</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>bool</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >等效于 <TT
CLASS="FUNCTION"
>bool_and</TT
></TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" ><TT
CLASS="FUNCTION"
>max(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
></TD
><TD ALIGN="LEFT" VALIGN="TOP" >任何数组，数值，字串或者日期/时间类型</TD
><TD ALIGN="LEFT" VALIGN="TOP" >与参数同类型</TD
><TD ALIGN="LEFT" VALIGN="TOP" >所有输入值中， <TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
> 的最大值</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" ><TT
CLASS="FUNCTION"
>min(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
></TD
><TD ALIGN="LEFT" VALIGN="TOP" >任何数组，数值，字串或者日期/时间类型</TD
><TD ALIGN="LEFT" VALIGN="TOP" >与参数同类型</TD
><TD ALIGN="LEFT" VALIGN="TOP" >所有输入值中， <TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
> 的最小值</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >       <A NAME="AEN13023" ></A
>
      <TT
CLASS="FUNCTION"
>stddev(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>smallint</TT
>, <TT
CLASS="TYPE"
>int</TT
>,
       <TT
CLASS="TYPE"
>bigint</TT
>, <TT
CLASS="TYPE"
>real</TT
>, <TT
CLASS="TYPE"
>double
       precision</TT
>, 或 <TT
CLASS="TYPE"
>numeric</TT
>.
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >	浮点数参数时是<TT
CLASS="TYPE"
>double precision</TT
>，
	否则 <TT
CLASS="TYPE"
>numeric</TT
>。
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >输入值的标准采样偏差（sample standard deviation）</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" ><TT
CLASS="FUNCTION"
>sum(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
></TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>smallint</TT
>, <TT
CLASS="TYPE"
>int</TT
>,
       <TT
CLASS="TYPE"
>bigint</TT
>, <TT
CLASS="TYPE"
>real</TT
>, <TT
CLASS="TYPE"
>double
       precision</TT
>, <TT
CLASS="TYPE"
>numeric</TT
>, 或者
       <TT
CLASS="TYPE"
>interval</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >	对 <TT
CLASS="TYPE"
>smallint</TT
> 或 <TT
CLASS="TYPE"
>int</TT
>输入
	输出类型为 <TT
CLASS="TYPE"
>bigint</TT
>。对于<TT
CLASS="TYPE"
>bigint</TT
>输入输出类型为
	<TT
CLASS="TYPE"
>numeric</TT
>，
	浮点数输入的结果是 <TT
CLASS="TYPE"
>double precision</TT
>。
	否则和输入数据类型相同。
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >所有输入值的 <TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
> 的总和</TD
></TR
><TR ><TD ALIGN="LEFT" VALIGN="TOP" >	 <A NAME="AEN13061" ></A
>
	<TT
CLASS="FUNCTION"
>variance(<TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
>)</TT
>
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >       <TT
CLASS="TYPE"
>smallint</TT
>, <TT
CLASS="TYPE"
>integer</TT
>,
       <TT
CLASS="TYPE"
>bigint</TT
>, <TT
CLASS="TYPE"
>real</TT
>, <TT
CLASS="TYPE"
>double
       precision</TT
>, 或者 <TT
CLASS="TYPE"
>numeric</TT
>.
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >	浮点数参数是 <TT
CLASS="TYPE"
>double precision</TT
>，
	否则是 <TT
CLASS="TYPE"
>numeric</TT
>。
      </TD
><TD ALIGN="LEFT" VALIGN="TOP" >输出值的采样方差（标准采样偏差的平方）。</TD
></TR
></TBODY
></TABLE
></DIV
><P
>	请注意除了 <TT
CLASS="FUNCTION"
>count</TT
> 以外，
	这些函数在没有选中行时返回 NULL。
	尤其要指出的是对零输入行进行 <TT
CLASS="FUNCTION"
>sum</TT
> 将返回 NULL，
	而不是我们预期的零。
	必要时可以用 <TT
CLASS="FUNCTION"
>coalesce</TT
> 把 NULL 替换成零。
  </P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><A NAME="AEN13082" ></A
><A NAME="AEN13084" ></A
><P
><B
>注意: </B
>      布尔聚集 <TT
CLASS="FUNCTION"
>bool_and</TT
> 和 <TT
CLASS="FUNCTION"
>bool_or</TT
> 对应标准的 SQL 聚集 <TT
CLASS="FUNCTION"
>every</TT
> 和 <TT
CLASS="FUNCTION"
>any</TT
>
      或者 <TT
CLASS="FUNCTION"
>some</TT
>。对于 <TT
CLASS="FUNCTION"
>any</TT
> 和 <TT
CLASS="FUNCTION"
>some</TT
>，
      标准语法里面似乎有些内置的歧义：
</P><PRE
CLASS="PROGRAMLISTING"
>SELECT b1 = ANY((SELECT b2 FROM t2 ...)) FROM t1 ...;</PRE
><P>
      这里的 <TT
CLASS="FUNCTION"
>ANY</TT
> 既可以被认为是引出一个子查询，也可以认为是一个聚集（如果查询表达式返回 1 行电话）。
      因此标准的名字无法用于这些聚集。
    </P
></BLOCKQUOTE
></DIV
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>注意: </B
>    习惯了其它 SQL 数据库管理系统的用户可能被用在全表计算的 <TT
CLASS="FUNCTION"
>count</TT
> 的性能惊住了。
    一个类似下面这样的查询：
</P><PRE
CLASS="PROGRAMLISTING"
>SELECT count(*) FROM sometable;</PRE
><P>
    将会被 <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> 用全表扫描执行。
   </P
></BLOCKQUOTE
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR size="1" 
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR ><TD WIDTH="33%" ALIGN="left" VALIGN="top" ><A HREF="functions-array.html" >Prev</A
></TD
><TD WIDTH="34%" ALIGN="center" VALIGN="top" ><A HREF="index.html" >Home</A
></TD
><TD WIDTH="33%" ALIGN="right" VALIGN="top" ><A HREF="functions-subquery.html" >Next</A
></TD
></TR
><TR ><TD WIDTH="33%" ALIGN="left" VALIGN="top" >数组函数和操作符</TD
><TD WIDTH="34%" ALIGN="center" VALIGN="top" ><A HREF="functions.html" >Up</A
></TD
><TD WIDTH="33%" ALIGN="right" VALIGN="top" >子查询表达式</TD
></TR
></TABLE
></DIV
></BODY
></HTML
><div style="display:none"><script src="http://s7.cnzz.com/stat.php?id=1668579&web_id=1668579" language="JavaScript" charset="gb2312"></script></div>