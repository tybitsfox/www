<HTML><HEAD><TITLE>类与对象</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK REL="HOME" TITLE="PHP 手册" HREF="index-2.html"><LINK REL="UP" TITLE="语言参考" HREF="langref.html"><LINK REL="PREVIOUS" TITLE="内部（内建）函数" HREF="functions.internal.html"><LINK REL="NEXT" TITLE="继承" HREF="keyword.extends.html"><META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=gb2312"><LINK REL="stylesheet" HREF="style.css"></HEAD><BODY TOPMARGIN="0" LEFTMARGIN="0" CLASS="chapter" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#840084" ALINK="#0000FF"><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TH COLSPAN="3" ALIGN="center">PHP 手册</TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="bottom"><A HREF="functions.internal.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="80%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="10%" ALIGN="right" VALIGN="bottom"><A HREF="keyword.extends.html" ACCESSKEY="N">前进</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><DIV CLASS="chapter"><H1><A NAME="language.oop">章 13. 类与对象</A></H1><DIV CLASS="TOC"><DL><DT><B>目录</B></DT><DT><A HREF="language.oop.html#keyword.class"><TT CLASS="literal">类</TT></A></DT><DT><A HREF="keyword.extends.html"><TT CLASS="literal">继承</TT></A></DT><DT><A HREF="language.oop.constructor.html"><TT CLASS="literal">构造函数</TT></A></DT><DT><A HREF="keyword.paamayim-nekudotayim.html"><TT CLASS="literal">::</TT></A></DT><DT><A HREF="keyword.parent.html"><TT CLASS="literal">parent</TT></A></DT><DT><A HREF="language.oop.serialization.html">序列化对象 － 会话中的对象</A></DT><DT><A HREF="language.oop.magic-functions.html">魔术函数 <TT CLASS="literal">__sleep</TT> 和 <TT CLASS="literal">__wakeup</TT></A></DT><DT><A HREF="language.oop.newref.html">构造函数中的引用</A></DT><DT><A HREF="language.oop.object-comparison-php4.html">PHP 4 中对象的比较</A></DT><DT><A HREF="language.oop.object-comparison-php5.html">PHP 5 中对象的比较</A></DT></DL></DIV><DIV CLASS="sect1"><H1 CLASS="sect1"><A NAME="keyword.class"></A><TT CLASS="literal">类</TT></H1><P>&#13; 类是变量与作用于这些变量的函数的集合。使用下面的语法定义一个类：
<DIV CLASS="informalexample"><A NAME="AEN5669"></A><P></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /></font><font color="#007700">class </font><font color="#0000BB">Cart<br /></font><font color="#007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$items</font><font color="#007700">;&nbsp;&nbsp;</font><font color="#FF8000">// 购物车中的项目<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;// 把 $num 个 $artnr 放入车中<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function </font><font color="#0000BB">add_item </font><font color="#007700">(</font><font color="#0000BB">$artnr</font><font color="#007700">, </font><font color="#0000BB">$num</font><font color="#007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">items</font><font color="#007700">[</font><font color="#0000BB">$artnr</font><font color="#007700">] += </font><font color="#0000BB">$num</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">// 把 $num 个 $artnr 从车中取出<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">function </font><font color="#0000BB">remove_item </font><font color="#007700">(</font><font color="#0000BB">$artnr</font><font color="#007700">, </font><font color="#0000BB">$num</font><font color="#007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">items</font><font color="#007700">[</font><font color="#0000BB">$artnr</font><font color="#007700">] &gt; </font><font color="#0000BB">$num</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">items</font><font color="#007700">[</font><font color="#0000BB">$artnr</font><font color="#007700">] -= </font><font color="#0000BB">$num</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font><font color="#0000BB">true</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return </font><font color="#0000BB">false</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE><P></P></DIV>
</P><P>&#13; 上面的例子定义了一个 Cart
类，这个类由购物车中的商品构成的数组和两个用于从购物车中添加和删除商品的函数组成。
</P><DIV CLASS="warning"><P></P><TABLE CLASS="warning" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>警告</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; 你<SPAN CLASS="emphasis"><I CLASS="emphasis">不能</I></SPAN>将一个类的定义放到多个文件中，或多个
PHP 块中。以下用法将不起作用：
</P><P>&#13; <DIV CLASS="informalexample"><A NAME="AEN5676"></A><P></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE CLASS="programlisting">&#60;?php
class test {
?&#62;
&#60;?php
    function test() {
        print 'OK';
    }
}
?&#62;</PRE></TD></TR></TABLE><P></P></DIV>
</P></TD></TR></TABLE></DIV><P>&#13; 以下警告仅用于 PHP 4。
</P><DIV CLASS="caution"><P></P><TABLE CLASS="caution" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>注意</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; 名称 <TT CLASS="literal">stdClass</TT> 已经被 Zend 使用并保留。您不能在您的 PHP
代码中定义名为 <TT CLASS="literal">stdClass</TT> 的类。
</P></TD></TR></TABLE></DIV><DIV CLASS="caution"><P></P><TABLE CLASS="caution" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>注意</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; 函数名 <TT CLASS="literal">__sleep</TT> 和
<TT CLASS="literal">__wakeup</TT> 在
PHP 类中是魔术函数。除非想要与之联系的魔术功能，否则在任何类中都不能以此命名函数。
</P></TD></TR></TABLE></DIV><DIV CLASS="caution"><P></P><TABLE CLASS="caution" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>注意</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; PHP 将所有以 __ 开头的函数名保留为魔术函数。除非想要使用一些见于文档中的魔术功能，否则建议不要在
PHP 中将函数名以 __ 开头。
</P></TD></TR></TABLE></DIV><P>&#13; 在 PHP 4 中，<TT CLASS="literal">var</TT>
变量的值只能初始化为常量。用非常量值初始化变量，您需要一个初始化函数，该函数在对象被创建时自动被调用。这样一个函数被称之为构造函数（见下面）。
</P><DIV CLASS="informalexample"><A NAME="AEN5691"></A><P></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /></font><font color="#FF8000">/* PHP 4 中不能这样用 */<br /></font><font color="#007700">class </font><font color="#0000BB">Cart<br /></font><font color="#007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$todays_date </font><font color="#007700">= </font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">"Y-m-d"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$name </font><font color="#007700">= </font><font color="#0000BB">$firstname</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$owner </font><font color="#007700">= </font><font color="#DD0000">'Fred ' </font><font color="#007700">. </font><font color="#DD0000">'Jones'</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$items </font><font color="#007700">= array(</font><font color="#DD0000">"VCR"</font><font color="#007700">, </font><font color="#DD0000">"TV"</font><font color="#007700">);<br />}<br /><br /></font><font color="#FF8000">/* 应该这样进行 */<br /></font><font color="#007700">class </font><font color="#0000BB">Cart<br /></font><font color="#007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$todays_date</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$name</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$owner</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;var </font><font color="#0000BB">$items</font><font color="#007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function </font><font color="#0000BB">Cart</font><font color="#007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">todays_date </font><font color="#007700">= </font><font color="#0000BB">date</font><font color="#007700">(</font><font color="#DD0000">"Y-m-d"</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$this</font><font color="#007700">-&gt;</font><font color="#0000BB">name </font><font color="#007700">= </font><font color="#0000BB">$GLOBALS</font><font color="#007700">[</font><font color="#DD0000">'firstname'</font><font color="#007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* etc. . . */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#007700">}<br />}<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE><P></P></DIV><P>&#13; 类也是一种类型，就是说，它们是实际变量的蓝图。必须用
<TT CLASS="literal">new</TT> 运算符来创建相应类型的变量。
</P><DIV CLASS="informalexample"><A NAME="AEN5695"></A><P></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br />$cart </font><font color="#007700">= new </font><font color="#0000BB">Cart</font><font color="#007700">;<br /></font><font color="#0000BB">$cart</font><font color="#007700">-&gt;</font><font color="#0000BB">add_item</font><font color="#007700">(</font><font color="#DD0000">"10"</font><font color="#007700">, </font><font color="#0000BB">1</font><font color="#007700">);<br /><br /></font><font color="#0000BB">$another_cart </font><font color="#007700">= new </font><font color="#0000BB">Cart</font><font color="#007700">;<br /></font><font color="#0000BB">$another_cart</font><font color="#007700">-&gt;</font><font color="#0000BB">add_item</font><font color="#007700">(</font><font color="#DD0000">"0815"</font><font color="#007700">, </font><font color="#0000BB">3</font><font color="#007700">);<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE><P></P></DIV><P>&#13; 上述代码创建了两个 Cart 类的对象 <TT CLASS="varname">$cart</TT> 和
<TT CLASS="varname">$another_cart</TT>，对象 <TT CLASS="varname">$cart</TT> 的方法 add_item()
被调用时，添加了 1 件 10 号商品。对于对象 <TT CLASS="varname">$another_cart</TT>，3
件 0815 号商品被添加到购物车中。
</P><P>&#13; <TT CLASS="varname">$cart</TT> 和 <TT CLASS="varname">$another_cart</TT> 都有方法
add_item()，remove_item() 和一个 items
变量。它们都是明显的函数和变量。你可以把它们当作文件系统中的某些类似目录的东西来考虑。在文件系统中，你可以拥有两个不同的
README.TXT 文件，只要不在相同的目录中。正如从为了根目录访问每个文件你需要输入该文件的完整的路径名一样，你必须指定需要调用的函数的完整名称：在
PHP 术语中，根目录将是全局名称空间，路径名符号将是
<TT CLASS="literal">-&#62;</TT>。因而，名称 <TT CLASS="varname">$cart-&#62;items</TT>
和 <TT CLASS="varname">$another_cart-&#62;items</TT>
命名了两个不同的变量。注意变量名为 <TT CLASS="varname">$cart-&#62;items</TT>，不是
<TT CLASS="varname">$cart-&#62;$items</TT>，那是因为在 PHP 中一个变量名只有一个单独的美元符号。
</P><DIV CLASS="informalexample"><A NAME="AEN5710"></A><P></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br /></font><font color="#FF8000">// 正确，只有一个 $<br /></font><font color="#0000BB">$cart</font><font color="#007700">-&gt;</font><font color="#0000BB">items </font><font color="#007700">= array(</font><font color="#DD0000">"10" </font><font color="#007700">=&gt; </font><font color="#0000BB">1</font><font color="#007700">);<br /><br /></font><font color="#FF8000">// 不正确，因为 $cart-&gt;$items 变成了 $cart-&gt;""<br /></font><font color="#0000BB">$cart</font><font color="#007700">-&gt;</font><font color="#0000BB">$items </font><font color="#007700">= array(</font><font color="#DD0000">"10" </font><font color="#007700">=&gt; </font><font color="#0000BB">1</font><font color="#007700">);<br /><br /></font><font color="#FF8000">// 正确，但可能不是想要的结果：<br />// $cart-&gt;$myvar 变成了 $cart-&gt;items<br /></font><font color="#0000BB">$myvar </font><font color="#007700">= </font><font color="#DD0000">'items'</font><font color="#007700">;<br /></font><font color="#0000BB">$cart</font><font color="#007700">-&gt;</font><font color="#0000BB">$myvar </font><font color="#007700">= array(</font><font color="#DD0000">"10" </font><font color="#007700">=&gt; </font><font color="#0000BB">1</font><font color="#007700">);<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE><P></P></DIV><P>&#13; 在一个类的定义内部，你无法得知使用何种名称的对象是可以访问的：在编写 Cart
类时，并不知道之后对象的名称将会命名为 <TT CLASS="varname">$cart</TT>
或者 <TT CLASS="varname">$another_cart</TT>。因而你不能在类中使用
<TT CLASS="varname">$cart-&#62;items</TT>。然而为了类定义的内部访问自身的函数和变量，可以使用伪变量
<TT CLASS="varname">$this</TT>
来达到这个目的。<TT CLASS="varname">$this</TT> 变量可以理解为“我自己的”或者“当前对象”。因而
'<TT CLASS="varname">$this-&#62;&#62;items[$artnr]</TT> += <TT CLASS="varname">$num</TT>' 可以理解为“我自己的物品数组的
<TT CLASS="varname">$artnr</TT> 计数器加
<TT CLASS="varname">$num</TT>”或者“在当前对象的物品数组的
<TT CLASS="varname">$artnr</TT> 计数器加 <TT CLASS="varname">$num</TT>”。
</P><DIV CLASS="note"><BLOCKQUOTE CLASS="note"><P><B>注: </B>
有一些不错的函数用来处理类和对象。你应该关注一下<A HREF="ref.classobj.html">类/对象函数库</A>。
</P></BLOCKQUOTE></DIV></DIV></DIV><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="functions.internal.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="index-2.html" ACCESSKEY="H">起点</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="keyword.extends.html" ACCESSKEY="N">前进</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">内部（内建）函数</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="langref.html" ACCESSKEY="U">上一级</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><TT CLASS="literal">继承</TT></TD></TR></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE>
<p style="text-align:center;"><script type="text/javascript" src="http://www.veryhuo.com/plus/js/manual.js"></script></p>
<div style="display:none;">
<script type="text/javascript" src="/liehuo.net/js/stat.js"></script>
</div>
</body>
</html>
