<HTML><HEAD><TITLE>Apache 服务器 2.x 版本</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK REL="HOME" TITLE="PHP 手册" HREF="index-2.html"><LINK REL="UP" TITLE="安装" HREF="installation.html"><LINK REL="PREVIOUS" TITLE="Apache 服务器 1.x 版本" HREF="install.apache.html"><LINK REL="NEXT" TITLE="Caudium 服务器" HREF="install.caudium.html"><META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=gb2312"><LINK REL="stylesheet" HREF="style.css"></HEAD><BODY TOPMARGIN="0" LEFTMARGIN="0" CLASS="sect1" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#840084" ALINK="#0000FF"><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TH COLSPAN="3" ALIGN="center">PHP 手册</TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="bottom"><A HREF="install.apache.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="80%" ALIGN="center" VALIGN="bottom">章 3. 安装</TD><TD WIDTH="10%" ALIGN="right" VALIGN="bottom"><A HREF="install.caudium.html" ACCESSKEY="N">前进</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><DIV CLASS="sect1"><H1 CLASS="sect1"><A NAME="install.apache2"></A>Apache 服务器 2.x 版本</H1><P>&#13; 本部分介绍了 <TT CLASS="literal">PHP</TT> 在 Apache 2.0
服务器上安装的提示和注意事项。本文所述的内容同时适用于
<A HREF="install.apache2.html#install.apache2.unix">Unix</A> 和
<A HREF="install.apache2.html#install.apache2.windows">Windows</A> 版本的 PHP。
</P><DIV CLASS="warning"><P></P><TABLE CLASS="warning" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>警告</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; 在企业级应用中无论是 Unix 还是 Windows 都不要使用 Apache 2.0 和
<TT CLASS="literal">PHP</TT> 的组合。
</P></TD></TR></TABLE></DIV><P>&#13; 推荐您查看 <A HREF="http://httpd.apache.org/docs-2.0/" TARGET="_top">Apache 文档</A>，了解一下
Apache 2.0 服务器。
</P><DIV CLASS="sect2"><H2 CLASS="sect2"><A NAME="compat.apache2"></A>PHP 和 Apache 2.0 的兼容性</H2><P>&#13; 如下版本的 PHP 可以正常工作在最新版本的 Apache 2.0 中：
<P></P><UL COMPACT="COMPACT"><LI><SPAN>&#13; PHP 4.3.0 或更高版本，下载地址：<A HREF="http://www.php.net/downloads.php" TARGET="_top">http://www.php.net/downloads.php</A>。
</SPAN></LI><LI><SPAN>&#13; 最新的稳定开发版本。在 <A HREF="http://snaps.php.net/php4-latest.tar.gz" TARGET="_top">&#13; http://snaps.php.net/php4-latest.tar.gz</A> 下载源代码或者在
<A HREF="http://snaps.php.net/win32/php4-win32-latest.zip" TARGET="_top">http://snaps.php.net/win32/php4-win32-latest.zip</A>
下载为 Windows 编译好的二进制文件。
</SPAN></LI><LI><SPAN>&#13; 预发布版本可以在
<A HREF="http://qa.php.net/" TARGET="_top">http://qa.php.net/</A> 下载。
</SPAN></LI><LI><SPAN>&#13; 您也可以通过对<A HREF="http://www.php.net/anoncvs.php" TARGET="_top">匿名 CVS</A>
的访问随时获得最新的 <TT CLASS="literal">PHP</TT>。
</SPAN></LI></UL>
这些版本的 <TT CLASS="literal">PHP</TT> 能够与 Apache 2.0.40 或更高版本兼容。
</P><DIV CLASS="note"><BLOCKQUOTE CLASS="note"><P><B>注: </B>
Apache 2.0 <TT CLASS="literal">SAPI</TT> 从 PHP 4.2.0 开始支持。PHP 4.2.3
可以工作在 Apache 2.0.39 下，不要尝试使用该版本的
<TT CLASS="literal">PHP</TT> 在其它任何版本的 Apache 2
下工作。我们建议的配置是将 PHP 4.3.0 安装在最新版本的 Apache 2 下。
</P><P>&#13; 所有提到的 <TT CLASS="literal">PHP</TT> 版本仍然能够在 Apache 1.3.x 下工作。
</P></BLOCKQUOTE></DIV></DIV><DIV CLASS="sect2"><H2 CLASS="sect2"><A NAME="install.apache2.unix"></A>Linux 下的 PHP 和 Apache 2.0</H2><P>&#13; 下载最新版本的 <A HREF="http://www.apache.org/" TARGET="_top">Apache
2.0</A>，并且根据上文选择合适版本的 PHP
下载。本向导仅包含最基础的内容，只能让 Apache 2.0 和
<TT CLASS="literal">PHP</TT> 能够正常工作。更多信息请阅读
<A HREF="http://httpd.apache.org/docs-2.0/" TARGET="_top">Apache
文档</A>。这里省略所有的版本号，以保证本文的正确性。您需要将本文的“NN”替换为相应的版本号。
</P><TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV CLASS="example"><A NAME="AEN1525"></A><P><B>例子 3-6.
安装说明（Apache 2 共享模块版本）
</B></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE CLASS="screen">1.  gzip -d httpd-2_0_NN.tar.gz
2.  tar xvf httpd-2_0_NN.tar
3.  gunzip php-NN.tar.gz
4.  tar -xvf php-NN.tar
5.  cd httpd-2_0_NN
6.  ./configure --enable-so
7.  make
8.  make install

    现在您已经将 Apache 2.0.NN 安装在 /usr/local/apache。本安装支持可装载模块
    和标准的 MPM prefork。之后，可以使用如下命令启动 Apache 服务器：
    /usr/local/apache2/bin/apachectl start
    如果成功，您可以停止 Apache 服务器并继续安装 PHP：
    /usr/local/apache2/bin/apachectl stop.

9.  cd ../php4-NN

10. 现在我们需要配置 PHP。在这里您可以用各种各样的参数来自定义PHP，例如启动哪
    些扩展功能包的支持等。用 ./configure --help 命令可以列出当前可用的所有参
    数。在我们的例子中，我们将给出一个在有 MySQL 支持的 Apache 2 上进行配置的
    范例。您本地的 apxs 的路径可能会不同，事实上，在您的系统中，它可能被命名为
    apxs2。

    ./configure --with-apxs2=/usr/local/apache2/bin/apxs

11. make
12. make install

    如果您决定在安装后改变配置选项，您只需重复最后的三步，然后需要重新启动
    Apache 使新模块生效。无需重新编译。

    请注意，除非明确有提示，否则 'make install' 命令将安装 PEAR、各种 PHP 工具
    诸如 phpize，安装 PHP CLI 等等。

13. 配置 php.ini

    cp php.ini-dist /usr/local/lib/php.ini

    您可以编辑 php.ini 文件以修改 PHP 的选项。如果您想要把此文件放到另外的位置，
    您需要在步骤 10 添加 --with-config-file-path=/path 选项。

    如果您选择 php.ini -recommended，请务必阅读其中的变更的列表，它们将影响
    PHP 的执行。

14. 编辑 httpd.conf 文件以调用 PHP 模块。LoadMolude 表达式右边的路径必须指向您
    系统中的 PHP。以上的 make install 命令可能已经帮您完成了这些，但务必要检查。

    对于 PHP 4：
       LoadModule php4_module modules/libphp4.so

    对于 PHP 5：
       LoadModule php5_module modules/libphp5.so

15. 告知 Apache 将特定的扩展名解析成 PHP，例如，我们让 Apache 将扩展名 .php
    解析成 PHP。您可以将任何扩展名指定为 PHP，只需添加它们，每一个用空格分隔。
    例如，我们要添加 .phtml：

    AddType application/x-httpd-php .php .phtml

    通常，我们还将 .phps 扩展名设置成显示高亮的 PHP 源文件，可以这样来完成：

    AddType application/x-httpd-php-source .phps

16. 启动您的 Apache 服务器：
   /usr/local/apache2/bin/apachectl start</PRE></TD></TR></TABLE></DIV></TD></TR></TABLE><P>&#13; 按照上面的步骤您便可以使 Apache 2.0 将 <TT CLASS="literal">PHP</TT> 作为
<TT CLASS="literal">SAPI</TT> 模块了。当然 Apache 和 <TT CLASS="literal">PHP</TT>
都还有很多配置选项，您可以在相应的源代码目录中使用
<B CLASS="command">./configure --help</B> 获得更多信息。假如您要编译一个多线程版本的
Apache 2.0，您必须覆盖标准的 MPM-Module <TT CLASS="filename">prefork</TT>，或者
<TT CLASS="filename">worker</TT> 或者
<TT CLASS="filename">perchild</TT>。要这样，您需要在上面的第
6 步使用 <TT CLASS="option">--with-mpm=worker</TT> 或者
<TT CLASS="option">--with-mpm=perchild</TT>
选项。之前您需要了解您正在做什么。更多信息请参考 Apache
文档中关于 <A HREF="http://httpd.apache.org/docs-2.0/mpm.html" TARGET="_top">MPM-Modules</A> 的部分。
</P><DIV CLASS="note"><BLOCKQUOTE CLASS="note"><P><B>注: </B>
要编译多线程版本的 Apache，您的系统必须支持多线程。这也意味着需要将
<TT CLASS="literal">PHP</TT> 编译为正处在试验阶段的 Zend Thread Safety
(ZTS)。因此并不是所有的扩展都可以使用了。推荐编译 Apache 使用标准的
<TT CLASS="filename">prefork</TT> MPM-Module。
</P></BLOCKQUOTE></DIV></DIV><DIV CLASS="sect2"><H2 CLASS="sect2"><A NAME="install.apache2.windows"></A>Windows 下的 PHP 和 Apache 2.0</H2><P>&#13; 您可以阅读 Apache 2.0 <A HREF="http://httpd.apache.org/docs-2.0/platform/windows.html" TARGET="_top">Windows
特别注意事项</A>。
</P><DIV CLASS="warning"><P></P><TABLE CLASS="warning" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>警告</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; Apache 2.0 被设计为运行在 Windows NT 4.0、Windows 2000 或 Windows
XP。现在并不支持 Windows 9x。目前不推荐 Apache 2.0 运行在上述平台。
</P></TD></TR></TABLE></DIV><P>&#13; 下载最新版本的 <A HREF="http://www.apache.org/" TARGET="_top">Apache 2.0</A>
和合适的 PHP 版本。 首先请查看<A HREF="install.windows.html#install.windows.manual">手动安装步骤</A>，然后回来继续安装
<TT CLASS="literal">PHP</TT> 和 Apache。
</P><P>&#13; 有两种方法使得 <TT CLASS="literal">PHP</TT> 工作在 Windows 下的 Apache。一是使用
CGI 二进制文件，另一是使用 Apache 模块 DLL。无聊那种方法，您首先必须停止
Apache 服务器，然后编辑 <TT CLASS="filename">httpd.conf</TT>，以配置 Apache 和 <TT CLASS="literal">PHP</TT>
协同工作。
</P><P>&#13; 您需要将如下指令插入到 Apache 的 <TT CLASS="filename">httpd.conf</TT> 配置文件中，以设置
<SPAN CLASS="emphasis"><I CLASS="emphasis">CGI 二进制文件</I></SPAN>：
<TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV CLASS="example"><A NAME="AEN1560"></A><P><B>例子 3-7. PHP 以 CGI 方式安装到 Apache 2.0</B></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE CLASS="apache">ScriptAlias /php/ "c:/php/"
AddType application/x-httpd-php .php
Action application/x-httpd-php "/php/php.exe"</PRE></TD></TR></TABLE></DIV></TD></TR></TABLE>
</P><P>&#13; 如果您想把 <TT CLASS="literal">PHP</TT> 作为 Apache 2.0 的模块，请务必移动
<TT CLASS="filename">php4ts.dll</TT> 到
<TT CLASS="filename">winnt/system32</TT>（Windows NT/2000）或
<TT CLASS="filename">windows/system32</TT>（Windows XP），覆盖原有文件（如果有的话），对于
PHP 5，这个文件是 <TT CLASS="filename">php5ts.dll</TT>。然后您需要插入如下两行到
<TT CLASS="filename">httpd.conf</TT> 中，以使您的 PHP 作为 Apache 的 <SPAN CLASS="emphasis"><I CLASS="emphasis">PHP-Module</I></SPAN> 安装：
<TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV CLASS="example"><A NAME="AEN1571"></A><P><B>例子 3-8. PHP 以模块方式安装到 Apache 2.0</B></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE CLASS="apache">; For PHP 4 do something like this:
LoadModule php4_module "c:/php/sapi/php4apache2.dll"
AddType application/x-httpd-php .php

; For PHP 5 do something like this:
LoadModule php5_module "c:/php/sapi/php5apache2.dll"
AddType application/x-httpd-php .php</PRE></TD></TR></TABLE></DIV></TD></TR></TABLE>
</P><DIV CLASS="note"><BLOCKQUOTE CLASS="note"><P><B>注: </B>
记得替换 <TT CLASS="filename">c:/php/</TT> 为您计算机上 <TT CLASS="literal">PHP</TT>
的实际路径。请注意在您的 LoadMolude 设置选项中使用
<TT CLASS="filename">php4apache2.dll</TT> 或者
<TT CLASS="filename">php5apache2.dll</TT>，<SPAN CLASS="emphasis"><I CLASS="emphasis">而非</I></SPAN>
<TT CLASS="filename">php4apache.dll</TT>，后者是为 Apache 1.3.x 设计的。
</P></BLOCKQUOTE></DIV><DIV CLASS="warning"><P></P><TABLE CLASS="warning" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>警告</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; 不要混用<SPAN CLASS="emphasis"><I CLASS="emphasis">不同 PHP 版本</I></SPAN>的 DLL
文件。您只能使用您下载的一个版本 PHP 中的 DLL 和扩展。
</P></TD></TR></TABLE></DIV></DIV></DIV><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="install.apache.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="index-2.html" ACCESSKEY="H">起点</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="install.caudium.html" ACCESSKEY="N">前进</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">Apache 服务器 1.x 版本</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="installation.html" ACCESSKEY="U">上一级</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">Caudium 服务器</TD></TR></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE>
<p style="text-align:center;"><script type="text/javascript" src="http://www.veryhuo.com/plus/js/manual.js"></script></p>
<div style="display:none;">
<script type="text/javascript" src="/liehuo.net/js/stat.js"></script>
</div>
</body>
</html>
