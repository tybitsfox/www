<HTML><HEAD><TITLE>mysqli_stmt_prepare</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK REL="HOME" TITLE="PHP 手册" HREF="index-2.html"><LINK REL="UP" TITLE="Improved MySQL Extension" HREF="ref.mysqli.html"><LINK REL="PREVIOUS" TITLE="mysqli_stmt_param_count" HREF="function.mysqli-stmt-param-count.html"><LINK REL="NEXT" TITLE="mysqli_stmt_result_metadata" HREF="function.mysqli-stmt-result-metadata.html"><META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=gb2312"><LINK REL="stylesheet" HREF="style.css"></HEAD><BODY TOPMARGIN="0" LEFTMARGIN="0" CLASS="refentry" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#840084" ALINK="#0000FF"><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TH COLSPAN="3" ALIGN="center">PHP 手册</TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="bottom"><A HREF="function.mysqli-stmt-param-count.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="80%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="10%" ALIGN="right" VALIGN="bottom"><A HREF="function.mysqli-stmt-result-metadata.html" ACCESSKEY="N">前进</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><H1><A NAME="function.mysqli-stmt-prepare"></A>mysqli_stmt_prepare</H1><DIV CLASS="refnamediv"><A NAME="AEN71038"></A><P> (no version information, might be only in CVS)</P>mysqli_stmt_prepare<P> (no version information, might be only in CVS)</P>stmt-&#62;prepare&nbsp;--&nbsp;
Prepare a SQL statement for execution
</DIV><DIV CLASS="refsect1"><A NAME="AEN71042"></A><H2>Description</H2><P>Procedure style:</P>bool <B CLASS="methodname">mysqli_stmt_prepare</B> ( object stmt, string query)<BR></BR><P>Object oriented style (method)</P>class <B CLASS="classname">stmt</B> { <BR></BR>mixed <B CLASS="methodname">prepare</B> ( string query)<BR></BR>}<P>&#13; <B CLASS="function">mysqli_stmt_prepare()</B> prepares the SQL query pointed to by the
null-terminated string query. The statement object has to be allocated by
<A HREF="function.mysqli-stmt-init.html"><B CLASS="function">mysqli_stmt_init()</B></A>.
The query must consist of a single SQL statement.
</P><DIV CLASS="note"><BLOCKQUOTE CLASS="note"><P><B>注: </B>
You should not add a terminating semicolon or <TT CLASS="literal">\g</TT>
to the statement.
</P></BLOCKQUOTE></DIV><P>&#13; The parameter <TT CLASS="parameter"><I>query</I></TT> can include one or more parameter markers
in the SQL statement by embedding question mark (<TT CLASS="literal">?</TT>) characters
at the appropriate positions.
</P><DIV CLASS="note"><BLOCKQUOTE CLASS="note"><P><B>注: </B>
The markers are legal only in certain places in SQL statements.
For example, they are allowed in the VALUES() list of an INSERT statement
(to specify column values for a row), or in a comparison with a column in
a WHERE clause to specify a comparison value.
</P><P>&#13; However, they are not allowed for identifiers (such as table or column names),
in the select list that names the columns to be returned by a SELECT statement),
or to specify both operands of a binary operator such as the <TT CLASS="literal">=</TT>
equal sign. The latter restriction is necessary because it would be impossible
to determine the parameter type. In general, parameters are legal only in Data
Manipulation Languange (DML) statements, and not in Data Defination Language
(DDL) statements.
</P></BLOCKQUOTE></DIV><P>&#13; The parameter markers must be bound to application variables using
<A HREF="function.mysqli-stmt-bind-param.html"><B CLASS="function">mysqli_stmt_bind_param()</B></A> and/or <A HREF="function.mysqli-stmt-bind-result.html"><B CLASS="function">mysqli_stmt_bind_result()</B></A>
before executing the statement or fetching rows.
</P></DIV><DIV CLASS="refsect1"><A NAME="AEN71080"></A><H2>返回值</H2><P>&#13; 如果成功则返回 <TT CLASS="constant"><B>TRUE</B></TT>，失败则返回 <TT CLASS="constant"><B>FALSE</B></TT>。
</P></DIV><DIV CLASS="refsect1"><A NAME="AEN71085"></A><H2>相关参考</H2><P>&#13; <A HREF="function.mysqli-stmt-init.html"><B CLASS="function">mysqli_stmt_init()</B></A>,
<A HREF="function.mysqli-stmt-execute.html"><B CLASS="function">mysqli_stmt_execute()</B></A>,
<A HREF="function.mysqli-stmt-fetch.html"><B CLASS="function">mysqli_stmt_fetch()</B></A>,
<A HREF="function.mysqli-stmt-bind-param.html"><B CLASS="function">mysqli_stmt_bind_param()</B></A>,
<A HREF="function.mysqli-stmt-bind-result.html"><B CLASS="function">mysqli_stmt_bind_result()</B></A>,
<A HREF="function.mysqli-stmt-close.html"><B CLASS="function">mysqli_stmt_close()</B></A>
</P></DIV><DIV CLASS="refsect1"><A NAME="AEN71094"></A><H2>Example</H2><TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV CLASS="example"><A NAME="AEN71096"></A><P><B>例子 1. Object oriented style</B></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br />$mysqli </font><font color="#007700">= new </font><font color="#0000BB">mysqli</font><font color="#007700">(</font><font color="#DD0000">"localhost"</font><font color="#007700">, </font><font color="#DD0000">"my_user"</font><font color="#007700">, </font><font color="#DD0000">"my_password"</font><font color="#007700">, </font><font color="#DD0000">"world"</font><font color="#007700">);<br /><br /></font><font color="#FF8000">/* check connection */<br /></font><font color="#007700">if (</font><font color="#0000BB">mysqli_connect_errno</font><font color="#007700">()) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">printf</font><font color="#007700">(</font><font color="#DD0000">"Connect failed: %s\n"</font><font color="#007700">, </font><font color="#0000BB">mysqli_connect_error</font><font color="#007700">());<br />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br />}<br /><br /></font><font color="#0000BB">$city </font><font color="#007700">= </font><font color="#DD0000">"Amersfoort"</font><font color="#007700">;<br /><br /></font><font color="#FF8000">/* create a prepared statement */<br /></font><font color="#0000BB">$stmt </font><font color="#007700">=&nbsp;&nbsp;</font><font color="#0000BB">$mysqli</font><font color="#007700">-&gt;</font><font color="#0000BB">stmt_init</font><font color="#007700">();<br />if (</font><font color="#0000BB">$stmt</font><font color="#007700">-&gt;</font><font color="#0000BB">prepare</font><font color="#007700">(</font><font color="#DD0000">"SELECT District FROM City WHERE Name=?"</font><font color="#007700">)) {<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* bind parameters for markers */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$stmt</font><font color="#007700">-&gt;</font><font color="#0000BB">bind_param</font><font color="#007700">(</font><font color="#DD0000">"s"</font><font color="#007700">, </font><font color="#0000BB">$city</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* execute query */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$stmt</font><font color="#007700">-&gt;</font><font color="#0000BB">execute</font><font color="#007700">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* bind result variables */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$stmt</font><font color="#007700">-&gt;</font><font color="#0000BB">bind_result</font><font color="#007700">(</font><font color="#0000BB">$district</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* fetch value */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$stmt</font><font color="#007700">-&gt;</font><font color="#0000BB">fetch</font><font color="#007700">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">printf</font><font color="#007700">(</font><font color="#DD0000">"%s is in district %s\n"</font><font color="#007700">, </font><font color="#0000BB">$city</font><font color="#007700">, </font><font color="#0000BB">$district</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* close statement */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$stmt</font><font color="#007700">-&gt;</font><font color="#0000BB">close</font><font color="#007700">();<br />} <br /><br /></font><font color="#FF8000">/* close connection */<br /></font><font color="#0000BB">$mysqli</font><font color="#007700">-&gt;</font><font color="#0000BB">close</font><font color="#007700">();<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE><TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV CLASS="example"><A NAME="AEN71099"></A><P><B>例子 2. Procedural style</B></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br />$link </font><font color="#007700">= </font><font color="#0000BB">mysqli_connect</font><font color="#007700">(</font><font color="#DD0000">"localhost"</font><font color="#007700">, </font><font color="#DD0000">"my_user"</font><font color="#007700">, </font><font color="#DD0000">"my_password"</font><font color="#007700">, </font><font color="#DD0000">"world"</font><font color="#007700">);<br /><br /></font><font color="#FF8000">/* check connection */<br /></font><font color="#007700">if (</font><font color="#0000BB">mysqli_connect_errno</font><font color="#007700">()) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">printf</font><font color="#007700">(</font><font color="#DD0000">"Connect failed: %s\n"</font><font color="#007700">, </font><font color="#0000BB">mysqli_connect_error</font><font color="#007700">());<br />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br />}<br /><br /></font><font color="#0000BB">$city </font><font color="#007700">= </font><font color="#DD0000">"Amersfoort"</font><font color="#007700">;<br /><br /></font><font color="#FF8000">/* create a prepared statement */<br /></font><font color="#0000BB">$stmt </font><font color="#007700">= </font><font color="#0000BB">mysqli_stmt_init</font><font color="#007700">();<br />if (</font><font color="#0000BB">$stmt </font><font color="#007700">= </font><font color="#0000BB">mysqli_stmt_prepare</font><font color="#007700">(</font><font color="#0000BB">$stmt</font><font color="#007700">, </font><font color="#DD0000">"SELECT District FROM City WHERE Name=?"</font><font color="#007700">)) {<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* bind parameters for markers */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">mysqli_stmt_bind_param</font><font color="#007700">(</font><font color="#0000BB">$stmt</font><font color="#007700">, </font><font color="#DD0000">"s"</font><font color="#007700">, </font><font color="#0000BB">$city</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* execute query */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">mysqli_stmt_execute</font><font color="#007700">(</font><font color="#0000BB">$stmt</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* bind result variables */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">mysqli_stmt_bind_result</font><font color="#007700">(</font><font color="#0000BB">$stmt</font><font color="#007700">, </font><font color="#0000BB">$district</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* fetch value */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">mysqli_stmt_fetch</font><font color="#007700">(</font><font color="#0000BB">$stmt</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">printf</font><font color="#007700">(</font><font color="#DD0000">"%s is in district %s\n"</font><font color="#007700">, </font><font color="#0000BB">$city</font><font color="#007700">, </font><font color="#0000BB">$district</font><font color="#007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF8000">/* close statement */<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">mysqli_stmt_close</font><font color="#007700">(</font><font color="#0000BB">$stmt</font><font color="#007700">);<br />} <br /><br /></font><font color="#FF8000">/* close connection */<br /></font><font color="#0000BB">mysqli_close</font><font color="#007700">(</font><font color="#0000BB">$link</font><font color="#007700">);<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE><P>&#13; The above examples would produce the following output:
</P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE CLASS="screen">Amersfoort is in district Utrecht</PRE></TD></TR></TABLE></DIV><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="function.mysqli-stmt-param-count.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="index-2.html" ACCESSKEY="H">起点</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="function.mysqli-stmt-result-metadata.html" ACCESSKEY="N">前进</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">mysqli_stmt_param_count</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="ref.mysqli.html" ACCESSKEY="U">上一级</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">mysqli_stmt_result_metadata</TD></TR></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE>
<p style="text-align:center;"><script type="text/javascript" src="http://www.veryhuo.com/plus/js/manual.js"></script></p>
<div style="display:none;">
<script type="text/javascript" src="/liehuo.net/js/stat.js"></script>
</div>
</body>
</html>
