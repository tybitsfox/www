<HTML><HEAD><TITLE>Using Extensions</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK REL="HOME" TITLE="PHP 手册" HREF="index-2.html"><LINK REL="UP" TITLE="Zend API" HREF="zend.html"><LINK REL="PREVIOUS" TITLE="Creating Extensions" HREF="zend.creating.html"><LINK REL="NEXT" TITLE="Troubleshooting" HREF="zend.troubleshooting.html"><META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=gb2312"><LINK REL="stylesheet" HREF="style.css"></HEAD><BODY TOPMARGIN="0" LEFTMARGIN="0" CLASS="chapter" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#840084" ALINK="#0000FF"><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TH COLSPAN="3" ALIGN="center">PHP 手册</TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="bottom"><A HREF="zend.creating.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="80%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="10%" ALIGN="right" VALIGN="bottom"><A HREF="zend.troubleshooting.html" ACCESSKEY="N">前进</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><DIV CLASS="chapter"><H1><A NAME="zend.using">章 29. Using Extensions</A></H1><P>&#13; Depending on the build process you selected, you should either end up
with a new PHP binary to be linked into your Web server (or run as CGI), or with an .so (shared object) file. If you compiled the
example file <TT CLASS="filename">first_module.c</TT> as a shared object, your result file
should be <TT CLASS="filename">first_module.so</TT>. To use it, you first have to copy
it to a place from which it's accessible to PHP. For a simple test procedure,
you can copy it to your <TT CLASS="filename">htdocs</TT> directory and try it with
the source in <A HREF="zend.using.html#example.testfile">例子 29-1</A>.
If you compiled it into the PHP binary,
omit the call to <A HREF="function.dl.html"><B CLASS="function">dl()</B></A>, as the module's
functionality is instantly available to your scripts.
<DIV CLASS="warning"><P></P><TABLE CLASS="warning" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>警告</B></TD></TR><TR><TD ALIGN="LEFT"><P>&#13; For security reasons, you <SPAN CLASS="emphasis"><I CLASS="emphasis">should not</I></SPAN> put your
dynamic modules into publicly accessible directories. Even though it <SPAN CLASS="emphasis"><I CLASS="emphasis">can</I></SPAN> be
done and it simplifies testing, you should put them into a separate directory
in production environments.
</P></TD></TR></TABLE></DIV>
</P><TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV CLASS="example"><A NAME="example.testfile"></A><P><B>例子 29-1. A test file for first_module.so.</B></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br />&nbsp;&nbsp;&nbsp;&nbsp;<br /></font><font color="#FF8000">// remove next comment if necessary<br />// dl("first_module.so"); <br /><br /></font><font color="#0000BB">$param </font><font color="#007700">= </font><font color="#0000BB">2</font><font color="#007700">;<br /></font><font color="#0000BB">$return </font><font color="#007700">= </font><font color="#0000BB">first_module</font><font color="#007700">(</font><font color="#0000BB">$param</font><font color="#007700">);<br /><br />print(</font><font color="#DD0000">"We sent '$param' and got '$return'"</font><font color="#007700">);<br /><br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE><P>&#13; Calling this PHP file in your Web browser should give you the
output shown in <A HREF="zend.using.html#fig.out-first">图形 29-1</A>.
<DIV CLASS="figure"><A NAME="fig.out-first"></A><P><B>图形 29-1. Output of first_module.php.</B></P><P><IMG SRC="figures/Extending_Zend_2_firstmod_output.png"></P></DIV>
</P><P>&#13; If required, the dynamic loadable module is loaded by calling the
<A HREF="function.dl.html"><B CLASS="function">dl()</B></A> function. This function looks for the
specified shared object, loads it, and makes its functions
available to PHP. The module exports the function
<B CLASS="function">first_module()</B>, which accepts a single
parameter, converts it to an integer, and returns the result of the
conversion.
</P><P>&#13; If you've gotten this far, congratulations! You just built your
first extension to PHP.
</P></DIV><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="zend.creating.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="index-2.html" ACCESSKEY="H">起点</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="zend.troubleshooting.html" ACCESSKEY="N">前进</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">Creating Extensions</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="zend.html" ACCESSKEY="U">上一级</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">Troubleshooting</TD></TR></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE>
<p style="text-align:center;"><script type="text/javascript" src="http://www.veryhuo.com/plus/js/manual.js"></script></p>
<div style="display:none;">
<script type="text/javascript" src="/liehuo.net/js/stat.js"></script>
</div>
</body>
</html>
