<HTML><HEAD><TITLE>Shared Memory Functions</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK REL="HOME" TITLE="PHP 手册" HREF="index-2.html"><LINK REL="UP" TITLE="函数参考" HREF="funcref.html"><LINK REL="PREVIOUS" TITLE="session_write_close" HREF="function.session-write-close.html"><LINK REL="NEXT" TITLE="shmop_close" HREF="function.shmop-close.html"><META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=gb2312"><LINK REL="stylesheet" HREF="style.css"></HEAD><BODY TOPMARGIN="0" LEFTMARGIN="0" CLASS="reference" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#840084" ALINK="#0000FF"><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD COLSPAN="3"><DIV CLASS="NAVHEADER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TH COLSPAN="3" ALIGN="center">PHP 手册</TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="bottom"><A HREF="function.session-write-close.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="80%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="10%" ALIGN="right" VALIGN="bottom"><A HREF="function.shmop-close.html" ACCESSKEY="N">前进</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR></TABLE></DIV></TD></TR><TR><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><BR><DIV CLASS="reference"><A NAME="ref.shmop"></A><DIV CLASS="TITLEPAGE"><H1 CLASS="title">XCVII. Shared Memory Functions</H1><DIV CLASS="PARTINTRO"><A NAME="AEN99557"></A><DIV CLASS="section"><H1 CLASS="section"><A NAME="shmop.intro"></A>介绍</H1><P>&#13; Shmop is an easy to use set of functions that allows PHP to read,
write, create and delete Unix shared memory segments. Note that versions
of Windows previous to Windows 2000 do not support shared memory. Under
Windows, Shmop will only work when PHP is running in ISAPI mode, such as
Apache or IIS (CLI and CGI will not work).
</P><DIV CLASS="note"><BLOCKQUOTE CLASS="note"><P><B>注: </B>
In PHP 4.0.3, these functions were prefixed by <TT CLASS="literal">shm</TT>
rather than <TT CLASS="literal">shmop</TT>.
</P></BLOCKQUOTE></DIV></DIV><DIV CLASS="section"><H1 CLASS="section"><A NAME="shmop.requirements"></A>需求</H1><P>无需外部库文件就可以加入本扩展模块的支持。</P></DIV><DIV CLASS="section"><H1 CLASS="section"><A NAME="shmop.installation"></A>安装</H1><P>&#13; To use shmop you will need to compile PHP with the
<TT CLASS="option">--enable-shmop</TT> parameter in your
configure line.
</P></DIV><DIV CLASS="section"><H1 CLASS="section"><A NAME="shmop.configuration"></A>运行时配置</H1><P>该扩展模块未定义任何设置指令。</P></DIV><DIV CLASS="section"><H1 CLASS="section"><A NAME="shmop.resources"></A>资源类型</H1><P>&#13; </P></DIV><DIV CLASS="section"><H1 CLASS="section"><A NAME="shmop.constants"></A>预定义常量</H1><P>该扩展模块未定义任何常量。</P></DIV><DIV CLASS="section"><H1 CLASS="section"><A NAME="shmop.examples"></A>范例</H1><P>&#13; <TABLE WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="EXAMPLE"><TR><TD><DIV CLASS="example"><A NAME="AEN99584"></A><P><B>例子 1. Shared Memory Operations Overview</B></P><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><code><font color="#000000">
<font color="#0000BB">&lt;?php<br />&nbsp;&nbsp;&nbsp;<br /></font><font color="#FF8000">// Create 100 byte shared memory block with system id if 0xff3<br /></font><font color="#0000BB">$shm_id </font><font color="#007700">= </font><font color="#0000BB">shmop_open</font><font color="#007700">(</font><font color="#0000BB">0xff3</font><font color="#007700">, </font><font color="#DD0000">"c"</font><font color="#007700">, </font><font color="#0000BB">0644</font><font color="#007700">, </font><font color="#0000BB">100</font><font color="#007700">);<br />if (!</font><font color="#0000BB">$shm_id</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"Couldn't create shared memory segment\n"</font><font color="#007700">;<br />}<br /><br /></font><font color="#FF8000">// Get shared memory block's size<br /></font><font color="#0000BB">$shm_size </font><font color="#007700">= </font><font color="#0000BB">shmop_size</font><font color="#007700">(</font><font color="#0000BB">$shm_id</font><font color="#007700">);<br />echo </font><font color="#DD0000">"SHM Block Size: " </font><font color="#007700">. </font><font color="#0000BB">$shm_size </font><font color="#007700">. </font><font color="#DD0000">" has been created.\n"</font><font color="#007700">;<br /><br /></font><font color="#FF8000">// Lets write a test string into shared memory<br /></font><font color="#0000BB">$shm_bytes_written </font><font color="#007700">= </font><font color="#0000BB">shmop_write</font><font color="#007700">(</font><font color="#0000BB">$shm_id</font><font color="#007700">, </font><font color="#DD0000">"my shared memory block"</font><font color="#007700">, </font><font color="#0000BB">0</font><font color="#007700">);<br />if (</font><font color="#0000BB">$shm_bytes_written </font><font color="#007700">!= </font><font color="#0000BB">strlen</font><font color="#007700">(</font><font color="#DD0000">"my shared memory block"</font><font color="#007700">)) {<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"Couldn't write the entire length of data\n"</font><font color="#007700">;<br />}<br /><br /></font><font color="#FF8000">// Now lets read the string back<br /></font><font color="#0000BB">$my_string </font><font color="#007700">= </font><font color="#0000BB">shmop_read</font><font color="#007700">(</font><font color="#0000BB">$shm_id</font><font color="#007700">, </font><font color="#0000BB">0</font><font color="#007700">, </font><font color="#0000BB">$shm_size</font><font color="#007700">);<br />if (!</font><font color="#0000BB">$my_string</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"Couldn't read from shared memory block\n"</font><font color="#007700">;<br />}<br />echo </font><font color="#DD0000">"The data inside shared memory was: " </font><font color="#007700">. </font><font color="#0000BB">$my_string </font><font color="#007700">. </font><font color="#DD0000">"\n"</font><font color="#007700">;<br /><br /></font><font color="#FF8000">//Now lets delete the block and close the shared memory segment<br /></font><font color="#007700">if (!</font><font color="#0000BB">shmop_delete</font><font color="#007700">(</font><font color="#0000BB">$shm_id</font><font color="#007700">)) {<br />&nbsp;&nbsp;&nbsp;&nbsp;echo </font><font color="#DD0000">"Couldn't mark shared memory block for deletion."</font><font color="#007700">;<br />}<br /></font><font color="#0000BB">shmop_close</font><font color="#007700">(</font><font color="#0000BB">$shm_id</font><font color="#007700">);<br />&nbsp;&nbsp;&nbsp;<br /></font><font color="#0000BB">?&gt;</font>
</font>
</code></TD></TR></TABLE></DIV></TD></TR></TABLE>
</P></DIV></DIV><DIV CLASS="TOC"><DL><DT><B>目录</B></DT><DT><A HREF="function.shmop-close.html">shmop_close</A>&nbsp;--&nbsp;Close shared memory block</DT><DT><A HREF="function.shmop-delete.html">shmop_delete</A>&nbsp;--&nbsp;Delete shared memory block</DT><DT><A HREF="function.shmop-open.html">shmop_open</A>&nbsp;--&nbsp;Create or open shared memory block</DT><DT><A HREF="function.shmop-read.html">shmop_read</A>&nbsp;--&nbsp;Read data from shared memory block</DT><DT><A HREF="function.shmop-size.html">shmop_size</A>&nbsp;--&nbsp;Get size of shared memory block</DT><DT><A HREF="function.shmop-write.html">shmop_write</A>&nbsp;--&nbsp;Write data into shared memory block</DT></DL></DIV></DIV></DIV><BR></TD><TD><IMG SRC="spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3"><DIV CLASS="NAVFOOTER"><TABLE BGCOLOR="#CCCCFF" BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD><IMG SRC="spacer.gif" BORDER="0" WIDTH="1" HEIGHT="1"><BR></TD></TR><TR><TD><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="3" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="function.session-write-close.html" ACCESSKEY="P">后退</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="index-2.html" ACCESSKEY="H">起点</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="function.shmop-close.html" ACCESSKEY="N">前进</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">session_write_close</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="funcref.html" ACCESSKEY="U">上一级</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">shmop_close</TD></TR></TABLE></TD></TR></TABLE></DIV></TD></TR></TABLE>
<p style="text-align:center;"><script type="text/javascript" src="http://www.veryhuo.com/plus/js/manual.js"></script></p>
<div style="display:none;">
<script type="text/javascript" src="/liehuo.net/js/stat.js"></script>
</div>
</body>
</html>
